{"name": "index.ts", "path": "source/index.ts", "sha": "a1dbca396feacef167895626f0db2eb76a99cd11", "size": 25763, "url": "https://api.github.com/repos/sindresorhus/p-queue/contents/source/index.ts?ref=main", "html_url": "https://github.com/sindresorhus/p-queue/blob/main/source/index.ts", "git_url": "https://api.github.com/repos/sindresorhus/p-queue/git/blobs/a1dbca396feacef167895626f0db2eb76a99cd11", "download_url": "https://raw.githubusercontent.com/sindresorhus/p-queue/main/source/index.ts", "type": "file", "content": "aW1wb3J0IHtFdmVudEVtaXR0ZXJ9IGZyb20gJ2V2ZW50ZW1pdHRlcjMnOwpp\nbXBvcnQgcFRpbWVvdXQgZnJvbSAncC10aW1lb3V0JzsKaW1wb3J0IHt0eXBl\nIFF1ZXVlLCB0eXBlIFJ1bkZ1bmN0aW9ufSBmcm9tICcuL3F1ZXVlLmpzJzsK\naW1wb3J0IFByaW9yaXR5UXVldWUgZnJvbSAnLi9wcmlvcml0eS1xdWV1ZS5q\ncyc7CmltcG9ydCB7dHlwZSBRdWV1ZUFkZE9wdGlvbnMsIHR5cGUgT3B0aW9u\ncywgdHlwZSBUYXNrT3B0aW9uc30gZnJvbSAnLi9vcHRpb25zLmpzJzsKCnR5\ncGUgVGFzazxUYXNrUmVzdWx0VHlwZT4gPQoJfCAoKG9wdGlvbnM6IFRhc2tP\ncHRpb25zKSA9PiBQcm9taXNlTGlrZTxUYXNrUmVzdWx0VHlwZT4pCgl8ICgo\nb3B0aW9uczogVGFza09wdGlvbnMpID0+IFRhc2tSZXN1bHRUeXBlKTsKCnR5\ncGUgRXZlbnROYW1lID0gJ2FjdGl2ZScgfCAnaWRsZScgfCAnZW1wdHknIHwg\nJ2FkZCcgfCAnbmV4dCcgfCAnY29tcGxldGVkJyB8ICdlcnJvcicgfCAncGVu\nZGluZ1plcm8nIHwgJ3JhdGVMaW1pdCcgfCAncmF0ZUxpbWl0Q2xlYXJlZCc7\nCgovKioKUHJvbWlzZSBxdWV1ZSB3aXRoIGNvbmN1cnJlbmN5IGNvbnRyb2wu\nCiovCmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBRdWV1ZTxRdWV1ZVR5cGUgZXh0\nZW5kcyBRdWV1ZTxSdW5GdW5jdGlvbiwgRW5xdWV1ZU9wdGlvbnNUeXBlPiA9\nIFByaW9yaXR5UXVldWUsIEVucXVldWVPcHRpb25zVHlwZSBleHRlbmRzIFF1\nZXVlQWRkT3B0aW9ucyA9IFF1ZXVlQWRkT3B0aW9ucz4gZXh0ZW5kcyBFdmVu\ndEVtaXR0ZXI8RXZlbnROYW1lPiB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUg\nQHR5cGVzY3JpcHQtZXNsaW50L25hbWluZy1jb252ZW50aW9uCglyZWFkb25s\neSAjY2FycnlvdmVySW50ZXJ2YWxDb3VudDogYm9vbGVhbjsKCglyZWFkb25s\neSAjaXNJbnRlcnZhbElnbm9yZWQ6IGJvb2xlYW47CgoJI2ludGVydmFsQ291\nbnQgPSAwOwoKCXJlYWRvbmx5ICNpbnRlcnZhbENhcDogbnVtYmVyOwoKCSNy\nYXRlTGltaXRlZEluSW50ZXJ2YWwgPSBmYWxzZTsKCSNyYXRlTGltaXRGbHVz\naFNjaGVkdWxlZCA9IGZhbHNlOwoKCXJlYWRvbmx5ICNpbnRlcnZhbDogbnVt\nYmVyOwoKCSNpbnRlcnZhbEVuZCA9IDA7CgoJI2xhc3RFeGVjdXRpb25UaW1l\nID0gMDsKCgkjaW50ZXJ2YWxJZD86IE5vZGVKUy5UaW1lb3V0OwoKCSN0aW1l\nb3V0SWQ/OiBOb2RlSlMuVGltZW91dDsKCglyZWFkb25seSAjc3RyaWN0OiBi\nb29sZWFuOwoKCS8vIENpcmN1bGFyIGJ1ZmZlciBpbXBsZW1lbnRhdGlvbiBm\nb3IgYmV0dGVyIHBlcmZvcm1hbmNlCgkjc3RyaWN0VGlja3M6IG51bWJlcltd\nID0gW107Cgkjc3RyaWN0VGlja3NTdGFydEluZGV4ID0gMDsKCgkjcXVldWU6\nIFF1ZXVlVHlwZTsKCglyZWFkb25seSAjcXVldWVDbGFzczogbmV3ICgpID0+\nIFF1ZXVlVHlwZTsKCgkjcGVuZGluZyA9IDA7CgoJLy8gVGhlIGAhYCBpcyBu\nZWVkZWQgYmVjYXVzZSBvZiBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0\nL1R5cGVTY3JpcHQvaXNzdWVzLzMyMTk0CgkjY29uY3VycmVuY3khOiBudW1i\nZXI7CgoJI2lzUGF1c2VkOiBib29sZWFuOwoKCS8vIFVzZSB0byBhc3NpZ24g\nYSB1bmlxdWUgaWRlbnRpZmllciB0byBhIHByb21pc2UgZnVuY3Rpb24sIGlm\nIG5vdCBleHBsaWNpdGx5IHNwZWNpZmllZAoJI2lkQXNzaWduZXIgPSAxbjsK\nCgkvLyBUcmFjayBjdXJyZW50bHkgcnVubmluZyB0YXNrcyBmb3IgZGVidWdn\naW5nCglyZWFkb25seSAjcnVubmluZ1Rhc2tzID0gbmV3IE1hcDxzeW1ib2ws\nIHsKCQlpZD86IHN0cmluZzsKCQlwcmlvcml0eTogbnVtYmVyOwoJCXN0YXJ0\nVGltZTogbnVtYmVyOwoJCXRpbWVvdXQ/OiBudW1iZXI7Cgl9PigpOwoKCS8q\nKgoJR2V0IG9yIHNldCB0aGUgZGVmYXVsdCB0aW1lb3V0IGZvciBhbGwgdGFz\na3MuIENhbiBiZSBjaGFuZ2VkIGF0IHJ1bnRpbWUuCgoJT3BlcmF0aW9ucyB3\naWxsIHRocm93IGEgYFRpbWVvdXRFcnJvcmAgaWYgdGhleSBkb24ndCBjb21w\nbGV0ZSB3aXRoaW4gdGhlIHNwZWNpZmllZCB0aW1lLgoKCVRoZSB0aW1lb3V0\nIGJlZ2lucyB3aGVuIHRoZSBvcGVyYXRpb24gaXMgZGVxdWV1ZWQgYW5kIHN0\nYXJ0cyBleGVjdXRpb24sIG5vdCB3aGlsZSBpdCdzIHdhaXRpbmcgaW4gdGhl\nIHF1ZXVlLgoKCUBleGFtcGxlCglgYGAKCWNvbnN0IHF1ZXVlID0gbmV3IFBR\ndWV1ZSh7dGltZW91dDogNTAwMH0pOwoKCS8vIENoYW5nZSB0aW1lb3V0IGZv\nciBhbGwgZnV0dXJlIHRhc2tzCglxdWV1ZS50aW1lb3V0ID0gMTAwMDA7Cglg\nYGAKCSovCgl0aW1lb3V0PzogbnVtYmVyOwoKCWNvbnN0cnVjdG9yKG9wdGlv\nbnM/OiBPcHRpb25zPFF1ZXVlVHlwZSwgRW5xdWV1ZU9wdGlvbnNUeXBlPikg\newoJCXN1cGVyKCk7CgoJCS8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBA\ndHlwZXNjcmlwdC1lc2xpbnQvY29uc2lzdGVudC10eXBlLWFzc2VydGlvbnMK\nCQlvcHRpb25zID0gewoJCQljYXJyeW92ZXJJbnRlcnZhbENvdW50OiBmYWxz\nZSwKCQkJaW50ZXJ2YWxDYXA6IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwK\nCQkJaW50ZXJ2YWw6IDAsCgkJCWNvbmN1cnJlbmN5OiBOdW1iZXIuUE9TSVRJ\nVkVfSU5GSU5JVFksCgkJCWF1dG9TdGFydDogdHJ1ZSwKCQkJcXVldWVDbGFz\nczogUHJpb3JpdHlRdWV1ZSwKCQkJc3RyaWN0OiBmYWxzZSwKCQkJLi4ub3B0\naW9ucywKCQl9IGFzIE9wdGlvbnM8UXVldWVUeXBlLCBFbnF1ZXVlT3B0aW9u\nc1R5cGU+OwoKCQlpZiAoISh0eXBlb2Ygb3B0aW9ucy5pbnRlcnZhbENhcCA9\nPT0gJ251bWJlcicgJiYgb3B0aW9ucy5pbnRlcnZhbENhcCA+PSAxKSkgewoJ\nCQl0aHJvdyBuZXcgVHlwZUVycm9yKGBFeHBlY3RlZCBcYGludGVydmFsQ2Fw\nXGAgdG8gYmUgYSBudW1iZXIgZnJvbSAxIGFuZCB1cCwgZ290IFxgJHtvcHRp\nb25zLmludGVydmFsQ2FwPy50b1N0cmluZygpID8/ICcnfVxgICgke3R5cGVv\nZiBvcHRpb25zLmludGVydmFsQ2FwfSlgKTsKCQl9CgoJCWlmIChvcHRpb25z\nLmludGVydmFsID09PSB1bmRlZmluZWQgfHwgIShOdW1iZXIuaXNGaW5pdGUo\nb3B0aW9ucy5pbnRlcnZhbCkgJiYgb3B0aW9ucy5pbnRlcnZhbCA+PSAwKSkg\newoJCQl0aHJvdyBuZXcgVHlwZUVycm9yKGBFeHBlY3RlZCBcYGludGVydmFs\nXGAgdG8gYmUgYSBmaW5pdGUgbnVtYmVyID49IDAsIGdvdCBcYCR7b3B0aW9u\ncy5pbnRlcnZhbD8udG9TdHJpbmcoKSA/PyAnJ31cYCAoJHt0eXBlb2Ygb3B0\naW9ucy5pbnRlcnZhbH0pYCk7CgkJfQoKCQlpZiAob3B0aW9ucy5zdHJpY3Qg\nJiYgb3B0aW9ucy5pbnRlcnZhbCA9PT0gMCkgewoJCQl0aHJvdyBuZXcgVHlw\nZUVycm9yKCdUaGUgYHN0cmljdGAgb3B0aW9uIHJlcXVpcmVzIGEgbm9uLXpl\ncm8gYGludGVydmFsYCcpOwoJCX0KCgkJaWYgKG9wdGlvbnMuc3RyaWN0ICYm\nIG9wdGlvbnMuaW50ZXJ2YWxDYXAgPT09IE51bWJlci5QT1NJVElWRV9JTkZJ\nTklUWSkgewoJCQl0aHJvdyBuZXcgVHlwZUVycm9yKCdUaGUgYHN0cmljdGAg\nb3B0aW9uIHJlcXVpcmVzIGEgZmluaXRlIGBpbnRlcnZhbENhcGAnKTsKCQl9\nCgoJCS8vIFRPRE86IFJlbW92ZSB0aGlzIGZhbGxiYWNrIGluIHRoZSBuZXh0\nIG1ham9yIHZlcnNpb24KCQkvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUg\nQHR5cGVzY3JpcHQtZXNsaW50L25vLWRlcHJlY2F0ZWQKCQl0aGlzLiNjYXJy\neW92ZXJJbnRlcnZhbENvdW50ID0gb3B0aW9ucy5jYXJyeW92ZXJJbnRlcnZh\nbENvdW50ID8/IG9wdGlvbnMuY2FycnlvdmVyQ29uY3VycmVuY3lDb3VudCA/\nPyBmYWxzZTsKCQl0aGlzLiNpc0ludGVydmFsSWdub3JlZCA9IG9wdGlvbnMu\naW50ZXJ2YWxDYXAgPT09IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSB8fCBv\ncHRpb25zLmludGVydmFsID09PSAwOwoJCXRoaXMuI2ludGVydmFsQ2FwID0g\nb3B0aW9ucy5pbnRlcnZhbENhcDsKCQl0aGlzLiNpbnRlcnZhbCA9IG9wdGlv\nbnMuaW50ZXJ2YWw7CgkJdGhpcy4jc3RyaWN0ID0gb3B0aW9ucy5zdHJpY3Qh\nOwoJCXRoaXMuI3F1ZXVlID0gbmV3IG9wdGlvbnMucXVldWVDbGFzcyEoKTsK\nCQl0aGlzLiNxdWV1ZUNsYXNzID0gb3B0aW9ucy5xdWV1ZUNsYXNzITsKCQl0\naGlzLmNvbmN1cnJlbmN5ID0gb3B0aW9ucy5jb25jdXJyZW5jeSE7CgoJCWlm\nIChvcHRpb25zLnRpbWVvdXQgIT09IHVuZGVmaW5lZCAmJiAhKE51bWJlci5p\nc0Zpbml0ZShvcHRpb25zLnRpbWVvdXQpICYmIG9wdGlvbnMudGltZW91dCA+\nIDApKSB7CgkJCXRocm93IG5ldyBUeXBlRXJyb3IoYEV4cGVjdGVkIFxgdGlt\nZW91dFxgIHRvIGJlIGEgcG9zaXRpdmUgZmluaXRlIG51bWJlciwgZ290IFxg\nJHtvcHRpb25zLnRpbWVvdXR9XGAgKCR7dHlwZW9mIG9wdGlvbnMudGltZW91\ndH0pYCk7CgkJfQoKCQl0aGlzLnRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQ7\nCgkJdGhpcy4jaXNQYXVzZWQgPSBvcHRpb25zLmF1dG9TdGFydCA9PT0gZmFs\nc2U7CgoJCXRoaXMuI3NldHVwUmF0ZUxpbWl0VHJhY2tpbmcoKTsKCX0KCgkj\nY2xlYW51cFN0cmljdFRpY2tzKG5vdzogbnVtYmVyKTogdm9pZCB7CgkJLy8g\nUmVtb3ZlIHRpY2tzIG91dHNpZGUgdGhlIGN1cnJlbnQgaW50ZXJ2YWwgd2lu\nZG93IHVzaW5nIGNpcmN1bGFyIGJ1ZmZlciBhcHByb2FjaAoJCXdoaWxlICh0\naGlzLiNzdHJpY3RUaWNrc1N0YXJ0SW5kZXggPCB0aGlzLiNzdHJpY3RUaWNr\ncy5sZW5ndGgpIHsKCQkJY29uc3Qgb2xkZXN0VGljayA9IHRoaXMuI3N0cmlj\ndFRpY2tzW3RoaXMuI3N0cmljdFRpY2tzU3RhcnRJbmRleF07CgkJCWlmIChv\nbGRlc3RUaWNrICE9PSB1bmRlZmluZWQgJiYgbm93IC0gb2xkZXN0VGljayA+\nPSB0aGlzLiNpbnRlcnZhbCkgewoJCQkJdGhpcy4jc3RyaWN0VGlja3NTdGFy\ndEluZGV4Kys7CgkJCX0gZWxzZSB7CgkJCQlicmVhazsKCQkJfQoJCX0KCgkJ\nLy8gQ29tcGFjdCB0aGUgYXJyYXkgd2hlbiBpdCBiZWNvbWVzIGluZWZmaWNp\nZW50IG9yIGZ1bGx5IGNvbnN1bWVkCgkJLy8gQ29tcGFjdCB3aGVuOiAoc3Rh\ncnQgaW5kZXggaXMgbGFyZ2UgQU5EIG1vcmUgdGhhbiBoYWxmIHdhc3RlZCkg\nT1IgYWxsIHRpY2tzIGV4cGlyZWQKCQljb25zdCBzaG91bGRDb21wYWN0ID0g\nKHRoaXMuI3N0cmljdFRpY2tzU3RhcnRJbmRleCA+IDEwMCAmJiB0aGlzLiNz\ndHJpY3RUaWNrc1N0YXJ0SW5kZXggPiB0aGlzLiNzdHJpY3RUaWNrcy5sZW5n\ndGggLyAyKQoJCQl8fCB0aGlzLiNzdHJpY3RUaWNrc1N0YXJ0SW5kZXggPT09\nIHRoaXMuI3N0cmljdFRpY2tzLmxlbmd0aDsKCgkJaWYgKHNob3VsZENvbXBh\nY3QpIHsKCQkJdGhpcy4jc3RyaWN0VGlja3MgPSB0aGlzLiNzdHJpY3RUaWNr\ncy5zbGljZSh0aGlzLiNzdHJpY3RUaWNrc1N0YXJ0SW5kZXgpOwoJCQl0aGlz\nLiNzdHJpY3RUaWNrc1N0YXJ0SW5kZXggPSAwOwoJCX0KCX0KCgkvLyBIZWxw\nZXIgbWV0aG9kcyBmb3IgaW50ZXJ2YWwgY29uc3VtcHRpb24KCSNjb25zdW1l\nSW50ZXJ2YWxTbG90KG5vdzogbnVtYmVyKTogdm9pZCB7CgkJaWYgKHRoaXMu\nI3N0cmljdCkgewoJCQl0aGlzLiNzdHJpY3RUaWNrcy5wdXNoKG5vdyk7CgkJ\nfSBlbHNlIHsKCQkJdGhpcy4jaW50ZXJ2YWxDb3VudCsrOwoJCX0KCX0KCgkj\ncm9sbGJhY2tJbnRlcnZhbFNsb3QoKTogdm9pZCB7CgkJaWYgKHRoaXMuI3N0\ncmljdCkgewoJCQkvLyBQb3AgZnJvbSB0aGUgZW5kIG9mIHRoZSBhY3R1YWwg\nZGF0YSAobm90IGZyb20gc3RhcnQgaW5kZXgpCgkJCWlmICh0aGlzLiNzdHJp\nY3RUaWNrcy5sZW5ndGggPiB0aGlzLiNzdHJpY3RUaWNrc1N0YXJ0SW5kZXgp\nIHsKCQkJCXRoaXMuI3N0cmljdFRpY2tzLnBvcCgpOwoJCQl9CgkJfSBlbHNl\nIGlmICh0aGlzLiNpbnRlcnZhbENvdW50ID4gMCkgewoJCQl0aGlzLiNpbnRl\ncnZhbENvdW50LS07CgkJfQoJfQoKCSNnZXRBY3RpdmVUaWNrc0NvdW50KCk6\nIG51bWJlciB7CgkJcmV0dXJuIHRoaXMuI3N0cmljdFRpY2tzLmxlbmd0aCAt\nIHRoaXMuI3N0cmljdFRpY2tzU3RhcnRJbmRleDsKCX0KCglnZXQgI2RvZXNJ\nbnRlcnZhbEFsbG93QW5vdGhlcigpOiBib29sZWFuIHsKCQlpZiAodGhpcy4j\naXNJbnRlcnZhbElnbm9yZWQpIHsKCQkJcmV0dXJuIHRydWU7CgkJfQoKCQlp\nZiAodGhpcy4jc3RyaWN0KSB7CgkJCS8vIENsZWFudXAgYWxyZWFkeSBkb25l\nIGJ5ICNpc0ludGVydmFsUGF1c2VkQXQgYmVmb3JlIHRoaXMgaXMgY2FsbGVk\nCgkJCXJldHVybiB0aGlzLiNnZXRBY3RpdmVUaWNrc0NvdW50KCkgPCB0aGlz\nLiNpbnRlcnZhbENhcDsKCQl9CgoJCXJldHVybiB0aGlzLiNpbnRlcnZhbENv\ndW50IDwgdGhpcy4jaW50ZXJ2YWxDYXA7Cgl9CgoJZ2V0ICNkb2VzQ29uY3Vy\ncmVudEFsbG93QW5vdGhlcigpOiBib29sZWFuIHsKCQlyZXR1cm4gdGhpcy4j\ncGVuZGluZyA8IHRoaXMuI2NvbmN1cnJlbmN5OwoJfQoKCSNuZXh0KCk6IHZv\naWQgewoJCXRoaXMuI3BlbmRpbmctLTsKCgkJaWYgKHRoaXMuI3BlbmRpbmcg\nPT09IDApIHsKCQkJdGhpcy5lbWl0KCdwZW5kaW5nWmVybycpOwoJCX0KCgkJ\ndGhpcy4jdHJ5VG9TdGFydEFub3RoZXIoKTsKCQl0aGlzLmVtaXQoJ25leHQn\nKTsKCX0KCgkjb25SZXN1bWVJbnRlcnZhbCgpOiB2b2lkIHsKCQkvLyBDbGVh\nciB0aW1lb3V0IElEIGJlZm9yZSBwcm9jZXNzaW5nIHRvIHByZXZlbnQgcmFj\nZSBjb25kaXRpb24KCQkvLyBNdXN0IGNsZWFyIGJlZm9yZSAjb25JbnRlcnZh\nbCB0byBhbGxvdyBuZXcgdGltZW91dHMgdG8gYmUgc2NoZWR1bGVkCgkJdGhp\ncy4jdGltZW91dElkID0gdW5kZWZpbmVkOwoJCXRoaXMuI29uSW50ZXJ2YWwo\nKTsKCQl0aGlzLiNpbml0aWFsaXplSW50ZXJ2YWxJZk5lZWRlZCgpOwoJfQoK\nCSNpc0ludGVydmFsUGF1c2VkQXQobm93OiBudW1iZXIpOiBib29sZWFuIHsK\nCQkvLyBTdHJpY3QgbW9kZTogY2hlY2sgaWYgd2UgbmVlZCB0byB3YWl0IGZv\nciBvbGRlc3QgdGljayB0byBhZ2Ugb3V0CgkJaWYgKHRoaXMuI3N0cmljdCkg\newoJCQl0aGlzLiNjbGVhbnVwU3RyaWN0VGlja3Mobm93KTsKCgkJCS8vIElm\nIGF0IGNhcGFjaXR5LCBuZWVkIHRvIHdhaXQgZm9yIG9sZGVzdCB0aWNrIHRv\nIGFnZSBvdXQKCQkJY29uc3QgYWN0aXZlVGlja3NDb3VudCA9IHRoaXMuI2dl\ndEFjdGl2ZVRpY2tzQ291bnQoKTsKCQkJaWYgKGFjdGl2ZVRpY2tzQ291bnQg\nPj0gdGhpcy4jaW50ZXJ2YWxDYXApIHsKCQkJCWNvbnN0IG9sZGVzdFRpY2sg\nPSB0aGlzLiNzdHJpY3RUaWNrc1t0aGlzLiNzdHJpY3RUaWNrc1N0YXJ0SW5k\nZXhdITsKCQkJCS8vIEFmdGVyIGNsZWFudXAsIHJlbWFpbmluZyB0aWNrcyBh\ncmUgd2l0aGluIGludGVydmFsLCBzbyBkZWxheSBpcyBhbHdheXMgPiAwCgkJ\nCQljb25zdCBkZWxheSA9IHRoaXMuI2ludGVydmFsIC0gKG5vdyAtIG9sZGVz\ndFRpY2spOwoJCQkJdGhpcy4jY3JlYXRlSW50ZXJ2YWxUaW1lb3V0KGRlbGF5\nKTsKCQkJCXJldHVybiB0cnVlOwoJCQl9CgoJCQlyZXR1cm4gZmFsc2U7CgkJ\nfQoKCQkvLyBGaXhlZCB3aW5kb3cgbW9kZSAob3JpZ2luYWwgbG9naWMpCgkJ\naWYgKHRoaXMuI2ludGVydmFsSWQgPT09IHVuZGVmaW5lZCkgewoJCQljb25z\ndCBkZWxheSA9IHRoaXMuI2ludGVydmFsRW5kIC0gbm93OwoJCQlpZiAoZGVs\nYXkgPCAwKSB7CgkJCQkvLyBJZiB0aGUgaW50ZXJ2YWwgaGFzIGV4cGlyZWQg\nd2hpbGUgaWRsZSwgY2hlY2sgaWYgd2Ugc2hvdWxkIGVuZm9yY2UgdGhlIGlu\ndGVydmFsCgkJCQkvLyBmcm9tIHRoZSBsYXN0IHRhc2sgZXhlY3V0aW9uLiBU\naGlzIGVuc3VyZXMgcHJvcGVyIHNwYWNpbmcgYmV0d2VlbiB0YXNrcyBldmVu\nCgkJCQkvLyB3aGVuIHRoZSBxdWV1ZSBiZWNvbWVzIGVtcHR5IGFuZCB0aGVu\nIG5ldyB0YXNrcyBhcmUgYWRkZWQuCgkJCQlpZiAodGhpcy4jbGFzdEV4ZWN1\ndGlvblRpbWUgPiAwKSB7CgkJCQkJY29uc3QgdGltZVNpbmNlTGFzdEV4ZWN1\ndGlvbiA9IG5vdyAtIHRoaXMuI2xhc3RFeGVjdXRpb25UaW1lOwoJCQkJCWlm\nICh0aW1lU2luY2VMYXN0RXhlY3V0aW9uIDwgdGhpcy4jaW50ZXJ2YWwpIHsK\nCQkJCQkJLy8gTm90IGVub3VnaCB0aW1lIGhhcyBwYXNzZWQgc2luY2UgdGhl\nIGxhc3QgdGFzayBleGVjdXRpb24KCQkJCQkJdGhpcy4jY3JlYXRlSW50ZXJ2\nYWxUaW1lb3V0KHRoaXMuI2ludGVydmFsIC0gdGltZVNpbmNlTGFzdEV4ZWN1\ndGlvbik7CgkJCQkJCXJldHVybiB0cnVlOwoJCQkJCX0KCQkJCX0KCgkJCQkv\nLyBFbm91Z2ggdGltZSBoYXMgcGFzc2VkIG9yIG5vIHByZXZpb3VzIGV4ZWN1\ndGlvbiwgYWxsb3cgZXhlY3V0aW9uCgkJCQl0aGlzLiNpbnRlcnZhbENvdW50\nID0gKHRoaXMuI2NhcnJ5b3ZlckludGVydmFsQ291bnQpID8gdGhpcy4jcGVu\nZGluZyA6IDA7CgkJCX0gZWxzZSB7CgkJCQkvLyBBY3QgYXMgdGhlIGludGVy\ndmFsIGlzIHBlbmRpbmcKCQkJCXRoaXMuI2NyZWF0ZUludGVydmFsVGltZW91\ndChkZWxheSk7CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfQoJCX0KCgkJcmV0dXJu\nIGZhbHNlOwoJfQoKCSNjcmVhdGVJbnRlcnZhbFRpbWVvdXQoZGVsYXk6IG51\nbWJlcik6IHZvaWQgewoJCWlmICh0aGlzLiN0aW1lb3V0SWQgIT09IHVuZGVm\naW5lZCkgewoJCQlyZXR1cm47CgkJfQoKCQl0aGlzLiN0aW1lb3V0SWQgPSBz\nZXRUaW1lb3V0KCgpID0+IHsKCQkJdGhpcy4jb25SZXN1bWVJbnRlcnZhbCgp\nOwoJCX0sIGRlbGF5KTsKCX0KCgkjY2xlYXJJbnRlcnZhbFRpbWVyKCk6IHZv\naWQgewoJCWlmICh0aGlzLiNpbnRlcnZhbElkKSB7CgkJCWNsZWFySW50ZXJ2\nYWwodGhpcy4jaW50ZXJ2YWxJZCk7CgkJCXRoaXMuI2ludGVydmFsSWQgPSB1\nbmRlZmluZWQ7CgkJfQoJfQoKCSNjbGVhclRpbWVvdXRUaW1lcigpOiB2b2lk\nIHsKCQlpZiAodGhpcy4jdGltZW91dElkKSB7CgkJCWNsZWFyVGltZW91dCh0\naGlzLiN0aW1lb3V0SWQpOwoJCQl0aGlzLiN0aW1lb3V0SWQgPSB1bmRlZmlu\nZWQ7CgkJfQoJfQoKCSN0cnlUb1N0YXJ0QW5vdGhlcigpOiBib29sZWFuIHsK\nCQlpZiAodGhpcy4jcXVldWUuc2l6ZSA9PT0gMCkgewoJCQkvLyBXZSBjYW4g\nY2xlYXIgdGhlIGludGVydmFsICgicGF1c2UiKQoJCQkvLyBCZWNhdXNlIHdl\nIGNhbiByZWRvIGl0IGxhdGVyICgicmVzdW1lIikKCQkJdGhpcy4jY2xlYXJJ\nbnRlcnZhbFRpbWVyKCk7CgkJCXRoaXMuZW1pdCgnZW1wdHknKTsKCgkJCWlm\nICh0aGlzLiNwZW5kaW5nID09PSAwKSB7CgkJCQkvLyBDbGVhciB0aW1lb3V0\nIGFzIHdlbGwgd2hlbiBjb21wbGV0ZWx5IGlkbGUKCQkJCXRoaXMuI2NsZWFy\nVGltZW91dFRpbWVyKCk7CgoJCQkJLy8gQ29tcGFjdCBzdHJpY3QgdGlja3Mg\nd2hlbiBpZGxlIHRvIGZyZWUgbWVtb3J5CgkJCQlpZiAodGhpcy4jc3RyaWN0\nICYmIHRoaXMuI3N0cmljdFRpY2tzU3RhcnRJbmRleCA+IDApIHsKCQkJCQlj\nb25zdCBub3cgPSBEYXRlLm5vdygpOwoJCQkJCXRoaXMuI2NsZWFudXBTdHJp\nY3RUaWNrcyhub3cpOwoJCQkJfQoKCQkJCXRoaXMuZW1pdCgnaWRsZScpOwoJ\nCQl9CgoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKCQlsZXQgdGFza1N0YXJ0ZWQg\nPSBmYWxzZTsKCgkJaWYgKCF0aGlzLiNpc1BhdXNlZCkgewoJCQljb25zdCBu\nb3cgPSBEYXRlLm5vdygpOwoJCQljb25zdCBjYW5Jbml0aWFsaXplSW50ZXJ2\nYWwgPSAhdGhpcy4jaXNJbnRlcnZhbFBhdXNlZEF0KG5vdyk7CgoJCQlpZiAo\ndGhpcy4jZG9lc0ludGVydmFsQWxsb3dBbm90aGVyICYmIHRoaXMuI2RvZXND\nb25jdXJyZW50QWxsb3dBbm90aGVyKSB7CgkJCQljb25zdCBqb2IgPSB0aGlz\nLiNxdWV1ZS5kZXF1ZXVlKCkhOwoKCQkJCWlmICghdGhpcy4jaXNJbnRlcnZh\nbElnbm9yZWQpIHsKCQkJCQl0aGlzLiNjb25zdW1lSW50ZXJ2YWxTbG90KG5v\ndyk7CgkJCQkJdGhpcy4jc2NoZWR1bGVSYXRlTGltaXRVcGRhdGUoKTsKCQkJ\nCX0KCgkJCQl0aGlzLmVtaXQoJ2FjdGl2ZScpOwoJCQkJam9iKCk7CgoJCQkJ\naWYgKGNhbkluaXRpYWxpemVJbnRlcnZhbCkgewoJCQkJCXRoaXMuI2luaXRp\nYWxpemVJbnRlcnZhbElmTmVlZGVkKCk7CgkJCQl9CgoJCQkJdGFza1N0YXJ0\nZWQgPSB0cnVlOwoJCQl9CgkJfQoKCQlyZXR1cm4gdGFza1N0YXJ0ZWQ7Cgl9\nCgoJI2luaXRpYWxpemVJbnRlcnZhbElmTmVlZGVkKCk6IHZvaWQgewoJCWlm\nICh0aGlzLiNpc0ludGVydmFsSWdub3JlZCB8fCB0aGlzLiNpbnRlcnZhbElk\nICE9PSB1bmRlZmluZWQpIHsKCQkJcmV0dXJuOwoJCX0KCgkJLy8gU3RyaWN0\nIG1vZGUgdXNlcyB0aW1lb3V0cyBpbnN0ZWFkIG9mIGludGVydmFsIHRpbWVy\ncwoJCWlmICh0aGlzLiNzdHJpY3QpIHsKCQkJcmV0dXJuOwoJCX0KCgkJdGhp\ncy4jaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKAoJCQkoKSA9PiB7CgkJCQl0\naGlzLiNvbkludGVydmFsKCk7CgkJCX0sCgkJCXRoaXMuI2ludGVydmFsLAoJ\nCSk7CgoJCXRoaXMuI2ludGVydmFsRW5kID0gRGF0ZS5ub3coKSArIHRoaXMu\nI2ludGVydmFsOwoJfQoKCSNvbkludGVydmFsKCk6IHZvaWQgewoJCS8vIE5v\nbi1zdHJpY3QgbW9kZSB1c2VzIGludGVydmFsIHRpbWVycyBhbmQgaW50ZXJ2\nYWxDb3VudAoJCWlmICghdGhpcy4jc3RyaWN0KSB7CgkJCWlmICh0aGlzLiNp\nbnRlcnZhbENvdW50ID09PSAwICYmIHRoaXMuI3BlbmRpbmcgPT09IDAgJiYg\ndGhpcy4jaW50ZXJ2YWxJZCkgewoJCQkJdGhpcy4jY2xlYXJJbnRlcnZhbFRp\nbWVyKCk7CgkJCX0KCgkJCXRoaXMuI2ludGVydmFsQ291bnQgPSB0aGlzLiNj\nYXJyeW92ZXJJbnRlcnZhbENvdW50ID8gdGhpcy4jcGVuZGluZyA6IDA7CgkJ\nfQoKCQl0aGlzLiNwcm9jZXNzUXVldWUoKTsKCQl0aGlzLiNzY2hlZHVsZVJh\ndGVMaW1pdFVwZGF0ZSgpOwoJfQoKCS8qKgoJRXhlY3V0ZXMgYWxsIHF1ZXVl\nZCBmdW5jdGlvbnMgdW50aWwgaXQgcmVhY2hlcyB0aGUgbGltaXQuCgkqLwoJ\nI3Byb2Nlc3NRdWV1ZSgpOiB2b2lkIHsKCQkvLyBlc2xpbnQtZGlzYWJsZS1u\nZXh0LWxpbmUgbm8tZW1wdHkKCQl3aGlsZSAodGhpcy4jdHJ5VG9TdGFydEFu\nb3RoZXIoKSkge30KCX0KCglnZXQgY29uY3VycmVuY3koKTogbnVtYmVyIHsK\nCQlyZXR1cm4gdGhpcy4jY29uY3VycmVuY3k7Cgl9CgoJc2V0IGNvbmN1cnJl\nbmN5KG5ld0NvbmN1cnJlbmN5OiBudW1iZXIpIHsKCQlpZiAoISh0eXBlb2Yg\nbmV3Q29uY3VycmVuY3kgPT09ICdudW1iZXInICYmIG5ld0NvbmN1cnJlbmN5\nID49IDEpKSB7CgkJCXRocm93IG5ldyBUeXBlRXJyb3IoYEV4cGVjdGVkIFxg\nY29uY3VycmVuY3lcYCB0byBiZSBhIG51bWJlciBmcm9tIDEgYW5kIHVwLCBn\nb3QgXGAke25ld0NvbmN1cnJlbmN5fVxgICgke3R5cGVvZiBuZXdDb25jdXJy\nZW5jeX0pYCk7CgkJfQoKCQl0aGlzLiNjb25jdXJyZW5jeSA9IG5ld0NvbmN1\ncnJlbmN5OwoKCQl0aGlzLiNwcm9jZXNzUXVldWUoKTsKCX0KCgkvKioKCVVw\nZGF0ZXMgdGhlIHByaW9yaXR5IG9mIGEgcHJvbWlzZSBmdW5jdGlvbiBieSBp\ndHMgaWQsIGFmZmVjdGluZyBpdHMgZXhlY3V0aW9uIG9yZGVyLiBSZXF1aXJl\ncyBhIGRlZmluZWQgY29uY3VycmVuY3kgbGltaXQgdG8gdGFrZSBlZmZlY3Qu\nCgoJRm9yIGV4YW1wbGUsIHRoaXMgY2FuIGJlIHVzZWQgdG8gcHJpb3JpdGl6\nZSBhIHByb21pc2UgZnVuY3Rpb24gdG8gcnVuIGVhcmxpZXIuCgoJYGBganMK\nCWltcG9ydCBQUXVldWUgZnJvbSAncC1xdWV1ZSc7CgoJY29uc3QgcXVldWUg\nPSBuZXcgUFF1ZXVlKHtjb25jdXJyZW5jeTogMX0pOwoKCXF1ZXVlLmFkZChh\nc3luYyAoKSA9PiAn8J+mhCcsIHtwcmlvcml0eTogMX0pOwoJcXVldWUuYWRk\nKGFzeW5jICgpID0+ICfwn6aAJywge3ByaW9yaXR5OiAwLCBpZDogJ/CfpoAn\nfSk7CglxdWV1ZS5hZGQoYXN5bmMgKCkgPT4gJ/CfpoQnLCB7cHJpb3JpdHk6\nIDF9KTsKCXF1ZXVlLmFkZChhc3luYyAoKSA9PiAn8J+mhCcsIHtwcmlvcml0\neTogMX0pOwoKCXF1ZXVlLnNldFByaW9yaXR5KCfwn6aAJywgMik7CglgYGAK\nCglJbiB0aGlzIGNhc2UsIHRoZSBwcm9taXNlIGZ1bmN0aW9uIHdpdGggYGlk\nOiAn8J+mgCdgIHJ1bnMgc2Vjb25kLgoKCVlvdSBjYW4gYWxzbyBkZXByaW9y\naXRpemUgYSBwcm9taXNlIGZ1bmN0aW9uIHRvIGRlbGF5IGl0cyBleGVjdXRp\nb246CgoJYGBganMKCWltcG9ydCBQUXVldWUgZnJvbSAncC1xdWV1ZSc7CgoJ\nY29uc3QgcXVldWUgPSBuZXcgUFF1ZXVlKHtjb25jdXJyZW5jeTogMX0pOwoK\nCXF1ZXVlLmFkZChhc3luYyAoKSA9PiAn8J+mhCcsIHtwcmlvcml0eTogMX0p\nOwoJcXVldWUuYWRkKGFzeW5jICgpID0+ICfwn6aAJywge3ByaW9yaXR5OiAx\nLCBpZDogJ/CfpoAnfSk7CglxdWV1ZS5hZGQoYXN5bmMgKCkgPT4gJ/CfpoQn\nKTsKCXF1ZXVlLmFkZChhc3luYyAoKSA9PiAn8J+mhCcsIHtwcmlvcml0eTog\nMH0pOwoKCXF1ZXVlLnNldFByaW9yaXR5KCfwn6aAJywgLTEpOwoJYGBgCglI\nZXJlLCB0aGUgcHJvbWlzZSBmdW5jdGlvbiB3aXRoIGBpZDogJ/CfpoAnYCBl\neGVjdXRlcyBsYXN0LgoJKi8KCXNldFByaW9yaXR5KGlkOiBzdHJpbmcsIHBy\naW9yaXR5OiBudW1iZXIpIHsKCQlpZiAodHlwZW9mIHByaW9yaXR5ICE9PSAn\nbnVtYmVyJyB8fCAhTnVtYmVyLmlzRmluaXRlKHByaW9yaXR5KSkgewoJCQl0\naHJvdyBuZXcgVHlwZUVycm9yKGBFeHBlY3RlZCBcYHByaW9yaXR5XGAgdG8g\nYmUgYSBmaW5pdGUgbnVtYmVyLCBnb3QgXGAke3ByaW9yaXR5fVxgICgke3R5\ncGVvZiBwcmlvcml0eX0pYCk7CgkJfQoKCQl0aGlzLiNxdWV1ZS5zZXRQcmlv\ncml0eShpZCwgcHJpb3JpdHkpOwoJfQoKCS8qKgoJQWRkcyBhIHN5bmMgb3Ig\nYXN5bmMgdGFzayB0byB0aGUgcXVldWUuIEFsd2F5cyByZXR1cm5zIGEgcHJv\nbWlzZS4KCSovCglhc3luYyBhZGQ8VGFza1Jlc3VsdFR5cGU+KGZ1bmN0aW9u\nXzogVGFzazxUYXNrUmVzdWx0VHlwZT4sIG9wdGlvbnM/OiBQYXJ0aWFsPEVu\ncXVldWVPcHRpb25zVHlwZT4pOiBQcm9taXNlPFRhc2tSZXN1bHRUeXBlPjsK\nCWFzeW5jIGFkZDxUYXNrUmVzdWx0VHlwZT4oZnVuY3Rpb25fOiBUYXNrPFRh\nc2tSZXN1bHRUeXBlPiwgb3B0aW9uczogUGFydGlhbDxFbnF1ZXVlT3B0aW9u\nc1R5cGU+ID0ge30pOiBQcm9taXNlPFRhc2tSZXN1bHRUeXBlPiB7CgkJLy8g\nQ3JlYXRlIGEgY29weSB0byBhdm9pZCBtdXRhdGluZyB0aGUgb3JpZ2luYWwg\nb3B0aW9ucyBvYmplY3QKCQlvcHRpb25zID0gewoJCQl0aW1lb3V0OiB0aGlz\nLnRpbWVvdXQsCgkJCS4uLm9wdGlvbnMsCgkJCS8vIEFzc2lnbiB1bmlxdWUg\nSUQgaWYgbm90IHByb3ZpZGVkCgkJCWlkOiBvcHRpb25zLmlkID8/ICh0aGlz\nLiNpZEFzc2lnbmVyKyspLnRvU3RyaW5nKCksCgkJfTsKCgkJcmV0dXJuIG5l\ndyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKCQkJLy8gQ3JlYXRl\nIGEgdW5pcXVlIHN5bWJvbCBmb3IgdHJhY2tpbmcgdGhpcyB0YXNrCgkJCWNv\nbnN0IHRhc2tTeW1ib2wgPSBTeW1ib2woYHRhc2stJHtvcHRpb25zLmlkfWAp\nOwoKCQkJdGhpcy4jcXVldWUuZW5xdWV1ZShhc3luYyAoKSA9PiB7CgkJCQl0\naGlzLiNwZW5kaW5nKys7CgoJCQkJLy8gVHJhY2sgdGhpcyBydW5uaW5nIHRh\nc2sKCQkJCXRoaXMuI3J1bm5pbmdUYXNrcy5zZXQodGFza1N5bWJvbCwgewoJ\nCQkJCWlkOiBvcHRpb25zLmlkLAoJCQkJCXByaW9yaXR5OiBvcHRpb25zLnBy\naW9yaXR5ID8/IDAsIC8vIE1hdGNoIHByaW9yaXR5LXF1ZXVlIGRlZmF1bHQK\nCQkJCQlzdGFydFRpbWU6IERhdGUubm93KCksCgkJCQkJdGltZW91dDogb3B0\naW9ucy50aW1lb3V0LAoJCQkJfSk7CgoJCQkJbGV0IGV2ZW50TGlzdGVuZXI6\nICgoKSA9PiB2b2lkKSB8IHVuZGVmaW5lZDsKCgkJCQl0cnkgewoJCQkJCS8v\nIENoZWNrIGFib3J0IHNpZ25hbCAtIGlmIGFib3J0ZWQsIG5lZWQgdG8gZGVj\ncmVtZW50IHRoZSBjb3VudGVyCgkJCQkJLy8gdGhhdCB3YXMgaW5jcmVtZW50\nZWQgaW4gdHJ5VG9TdGFydEFub3RoZXIKCQkJCQl0cnkgewoJCQkJCQlvcHRp\nb25zLnNpZ25hbD8udGhyb3dJZkFib3J0ZWQoKTsKCQkJCQl9IGNhdGNoIChl\ncnJvcikgewoJCQkJCQl0aGlzLiNyb2xsYmFja0ludGVydmFsQ29uc3VtcHRp\nb24oKTsKCgkJCQkJCS8vIENsZWFuIHVwIHRyYWNraW5nIGJlZm9yZSB0aHJv\nd2luZwoJCQkJCQl0aGlzLiNydW5uaW5nVGFza3MuZGVsZXRlKHRhc2tTeW1i\nb2wpOwoKCQkJCQkJdGhyb3cgZXJyb3I7CgkJCQkJfQoKCQkJCQl0aGlzLiNs\nYXN0RXhlY3V0aW9uVGltZSA9IERhdGUubm93KCk7CgoJCQkJCWxldCBvcGVy\nYXRpb24gPSBmdW5jdGlvbl8oe3NpZ25hbDogb3B0aW9ucy5zaWduYWx9KTsK\nCgkJCQkJaWYgKG9wdGlvbnMudGltZW91dCkgewoJCQkJCQlvcGVyYXRpb24g\nPSBwVGltZW91dChQcm9taXNlLnJlc29sdmUob3BlcmF0aW9uKSwgewoJCQkJ\nCQkJbWlsbGlzZWNvbmRzOiBvcHRpb25zLnRpbWVvdXQsCgkJCQkJCQltZXNz\nYWdlOiBgVGFzayB0aW1lZCBvdXQgYWZ0ZXIgJHtvcHRpb25zLnRpbWVvdXR9\nbXMgKHF1ZXVlIGhhcyAke3RoaXMuI3BlbmRpbmd9IHJ1bm5pbmcsICR7dGhp\ncy4jcXVldWUuc2l6ZX0gd2FpdGluZylgLAoJCQkJCQl9KTsKCQkJCQl9CgoJ\nCQkJCWlmIChvcHRpb25zLnNpZ25hbCkgewoJCQkJCQljb25zdCB7c2lnbmFs\nfSA9IG9wdGlvbnM7CgoJCQkJCQlvcGVyYXRpb24gPSBQcm9taXNlLnJhY2Uo\nW29wZXJhdGlvbiwgbmV3IFByb21pc2U8bmV2ZXI+KChfcmVzb2x2ZSwgcmVq\nZWN0KSA9PiB7CgkJCQkJCQlldmVudExpc3RlbmVyID0gKCkgPT4gewoJCQkJ\nCQkJCXJlamVjdChzaWduYWwucmVhc29uKTsKCQkJCQkJCX07CgoJCQkJCQkJ\nc2lnbmFsLmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgZXZlbnRMaXN0ZW5l\nciwge29uY2U6IHRydWV9KTsKCQkJCQkJfSldKTsKCQkJCQl9CgoJCQkJCWNv\nbnN0IHJlc3VsdCA9IGF3YWl0IG9wZXJhdGlvbjsKCQkJCQlyZXNvbHZlKHJl\nc3VsdCk7CgkJCQkJdGhpcy5lbWl0KCdjb21wbGV0ZWQnLCByZXN1bHQpOwoJ\nCQkJfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHsKCQkJCQlyZWplY3QoZXJy\nb3IpOwoJCQkJCXRoaXMuZW1pdCgnZXJyb3InLCBlcnJvcik7CgkJCQl9IGZp\nbmFsbHkgewoJCQkJCS8vIENsZWFuIHVwIGFib3J0IGV2ZW50IGxpc3RlbmVy\nCgkJCQkJaWYgKGV2ZW50TGlzdGVuZXIpIHsKCQkJCQkJb3B0aW9ucy5zaWdu\nYWw/LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgZXZlbnRMaXN0ZW5l\ncik7CgkJCQkJfQoKCQkJCQkvLyBSZW1vdmUgZnJvbSBydW5uaW5nIHRhc2tz\nCgkJCQkJdGhpcy4jcnVubmluZ1Rhc2tzLmRlbGV0ZSh0YXNrU3ltYm9sKTsK\nCgkJCQkJLy8gVXNlIHF1ZXVlTWljcm90YXNrIHRvIHByZXZlbnQgZGVlcCBy\nZWN1cnNpb24gd2hpbGUgbWFpbnRhaW5pbmcgdGltaW5nCgkJCQkJcXVldWVN\naWNyb3Rhc2soKCkgPT4gewoJCQkJCQl0aGlzLiNuZXh0KCk7CgkJCQkJfSk7\nCgkJCQl9CgkJCX0sIG9wdGlvbnMpOwoKCQkJdGhpcy5lbWl0KCdhZGQnKTsK\nCgkJCXRoaXMuI3RyeVRvU3RhcnRBbm90aGVyKCk7CgkJfSk7Cgl9CgoJLyoq\nCglTYW1lIGFzIGAuYWRkKClgLCBidXQgYWNjZXB0cyBhbiBhcnJheSBvZiBz\neW5jIG9yIGFzeW5jIGZ1bmN0aW9ucy4KCglAcmV0dXJucyBBIHByb21pc2Ug\ndGhhdCByZXNvbHZlcyB3aGVuIGFsbCBmdW5jdGlvbnMgYXJlIHJlc29sdmVk\nLgoJKi8KCWFzeW5jIGFkZEFsbDxUYXNrUmVzdWx0c1R5cGU+KAoJCWZ1bmN0\naW9uczogUmVhZG9ubHlBcnJheTxUYXNrPFRhc2tSZXN1bHRzVHlwZT4+LAoJ\nCW9wdGlvbnM/OiBQYXJ0aWFsPEVucXVldWVPcHRpb25zVHlwZT4sCgkpOiBQ\ncm9taXNlPFRhc2tSZXN1bHRzVHlwZVtdPjsKCWFzeW5jIGFkZEFsbDxUYXNr\nUmVzdWx0c1R5cGU+KAoJCWZ1bmN0aW9uczogUmVhZG9ubHlBcnJheTxUYXNr\nPFRhc2tSZXN1bHRzVHlwZT4+LAoJCW9wdGlvbnM/OiBQYXJ0aWFsPEVucXVl\ndWVPcHRpb25zVHlwZT4sCgkpOiBQcm9taXNlPFRhc2tSZXN1bHRzVHlwZVtd\nPiB7CgkJcmV0dXJuIFByb21pc2UuYWxsKGZ1bmN0aW9ucy5tYXAoYXN5bmMg\nZnVuY3Rpb25fID0+IHRoaXMuYWRkKGZ1bmN0aW9uXywgb3B0aW9ucykpKTsK\nCX0KCgkvKioKCVN0YXJ0IChvciByZXN1bWUpIGV4ZWN1dGluZyBlbnF1ZXVl\nZCB0YXNrcyB3aXRoaW4gY29uY3VycmVuY3kgbGltaXQuIE5vIG5lZWQgdG8g\nY2FsbCB0aGlzIGlmIHF1ZXVlIGlzIG5vdCBwYXVzZWQgKHZpYSBgb3B0aW9u\ncy5hdXRvU3RhcnQgPSBmYWxzZWAgb3IgYnkgYC5wYXVzZSgpYCBtZXRob2Qu\nKQoJKi8KCXN0YXJ0KCk6IHRoaXMgewoJCWlmICghdGhpcy4jaXNQYXVzZWQp\nIHsKCQkJcmV0dXJuIHRoaXM7CgkJfQoKCQl0aGlzLiNpc1BhdXNlZCA9IGZh\nbHNlOwoKCQl0aGlzLiNwcm9jZXNzUXVldWUoKTsKCQlyZXR1cm4gdGhpczsK\nCX0KCgkvKioKCVB1dCBxdWV1ZSBleGVjdXRpb24gb24gaG9sZC4KCSovCglw\nYXVzZSgpOiB2b2lkIHsKCQl0aGlzLiNpc1BhdXNlZCA9IHRydWU7Cgl9CgoJ\nLyoqCglDbGVhciB0aGUgcXVldWUuCgkqLwoJY2xlYXIoKTogdm9pZCB7CgkJ\ndGhpcy4jcXVldWUgPSBuZXcgdGhpcy4jcXVldWVDbGFzcygpOwoKCQkvLyBD\nbGVhciBpbnRlcnZhbCB0aW1lciBzaW5jZSBxdWV1ZSBpcyBub3cgZW1wdHkg\nKGNvbnNpc3RlbnQgd2l0aCAjdHJ5VG9TdGFydEFub3RoZXIpCgkJdGhpcy4j\nY2xlYXJJbnRlcnZhbFRpbWVyKCk7CgoJCS8vIE5vdGU6IFdlIHByZXNlcnZl\nIHN0cmljdCBtb2RlIHJhdGUtbGltaXRpbmcgc3RhdGUgKHRpY2tzIGFuZCB0\naW1lb3V0KQoJCS8vIGJlY2F1c2UgY2xlYXIoKSBvbmx5IGNsZWFycyBxdWV1\nZWQgdGFza3MsIG5vdCByYXRlIGxpbWl0IGhpc3RvcnkuCgkJLy8gVGhpcyBl\nbnN1cmVzIHRoYXQgcmF0ZSBsaW1pdHMgYXJlIHN0aWxsIGVuZm9yY2VkIGFm\ndGVyIGNsZWFyaW5nIHRoZSBxdWV1ZS4KCgkJLy8gTm90ZTogV2UgZG9uJ3Qg\nY2xlYXIgI3J1bm5pbmdUYXNrcyBhcyB0aG9zZSB0YXNrcyBhcmUgc3RpbGwg\ncnVubmluZwoJCS8vIFRoZXkgd2lsbCBiZSByZW1vdmVkIHdoZW4gdGhleSBj\nb21wbGV0ZSBpbiB0aGUgZmluYWxseSBibG9jawoKCQkvLyBGb3JjZSBzeW5j\naHJvbm91cyB1cGRhdGUgc2luY2UgY2xlYXIoKSBzaG91bGQgaGF2ZSBpbW1l\nZGlhdGUgZWZmZWN0CgkJdGhpcy4jdXBkYXRlUmF0ZUxpbWl0U3RhdGUoKTsK\nCgkJLy8gRW1pdCBldmVudHMgc28gd2FpdGVycyAob25FbXB0eSwgb25JZGxl\nLCBvblNpemVMZXNzVGhhbikgY2FuIHJlc29sdmUKCQl0aGlzLmVtaXQoJ2Vt\ncHR5Jyk7CgoJCWlmICh0aGlzLiNwZW5kaW5nID09PSAwKSB7CgkJCXRoaXMu\nI2NsZWFyVGltZW91dFRpbWVyKCk7CgkJCXRoaXMuZW1pdCgnaWRsZScpOwoJ\nCX0KCgkJdGhpcy5lbWl0KCduZXh0Jyk7Cgl9CgoJLyoqCglDYW4gYmUgY2Fs\nbGVkIG11bHRpcGxlIHRpbWVzLiBVc2VmdWwgaWYgeW91IGZvciBleGFtcGxl\nIGFkZCBhZGRpdGlvbmFsIGl0ZW1zIGF0IGEgbGF0ZXIgdGltZS4KCglAcmV0\ndXJucyBBIHByb21pc2UgdGhhdCBzZXR0bGVzIHdoZW4gdGhlIHF1ZXVlIGJl\nY29tZXMgZW1wdHkuCgkqLwoJYXN5bmMgb25FbXB0eSgpOiBQcm9taXNlPHZv\naWQ+IHsKCQkvLyBJbnN0YW50bHkgcmVzb2x2ZSBpZiB0aGUgcXVldWUgaXMg\nZW1wdHkKCQlpZiAodGhpcy4jcXVldWUuc2l6ZSA9PT0gMCkgewoJCQlyZXR1\ncm47CgkJfQoKCQlhd2FpdCB0aGlzLiNvbkV2ZW50KCdlbXB0eScpOwoJfQoK\nCS8qKgoJQHJldHVybnMgQSBwcm9taXNlIHRoYXQgc2V0dGxlcyB3aGVuIHRo\nZSBxdWV1ZSBzaXplIGlzIGxlc3MgdGhhbiB0aGUgZ2l2ZW4gbGltaXQ6IGBx\ndWV1ZS5zaXplIDwgbGltaXRgLgoKCUlmIHlvdSB3YW50IHRvIGF2b2lkIGhh\ndmluZyB0aGUgcXVldWUgZ3JvdyBiZXlvbmQgYSBjZXJ0YWluIHNpemUgeW91\nIGNhbiBgYXdhaXQgcXVldWUub25TaXplTGVzc1RoYW4oKWAgYmVmb3JlIGFk\nZGluZyBhIG5ldyBpdGVtLgoKCU5vdGUgdGhhdCB0aGlzIG9ubHkgbGltaXRz\nIHRoZSBudW1iZXIgb2YgaXRlbXMgd2FpdGluZyB0byBzdGFydC4gVGhlcmUg\nY291bGQgc3RpbGwgYmUgdXAgdG8gYGNvbmN1cnJlbmN5YCBqb2JzIGFscmVh\nZHkgcnVubmluZyB0aGF0IHRoaXMgY2FsbCBkb2VzIG5vdCBpbmNsdWRlIGlu\nIGl0cyBjYWxjdWxhdGlvbi4KCSovCglhc3luYyBvblNpemVMZXNzVGhhbihs\naW1pdDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7CgkJLy8gSW5zdGFudGx5\nIHJlc29sdmUgaWYgdGhlIHF1ZXVlIGlzIGVtcHR5LgoJCWlmICh0aGlzLiNx\ndWV1ZS5zaXplIDwgbGltaXQpIHsKCQkJcmV0dXJuOwoJCX0KCgkJYXdhaXQg\ndGhpcy4jb25FdmVudCgnbmV4dCcsICgpID0+IHRoaXMuI3F1ZXVlLnNpemUg\nPCBsaW1pdCk7Cgl9CgoJLyoqCglUaGUgZGlmZmVyZW5jZSB3aXRoIGAub25F\nbXB0eWAgaXMgdGhhdCBgLm9uSWRsZWAgZ3VhcmFudGVlcyB0aGF0IGFsbCB3\nb3JrIGZyb20gdGhlIHF1ZXVlIGhhcyBmaW5pc2hlZC4gYC5vbkVtcHR5YCBt\nZXJlbHkgc2lnbmFscyB0aGF0IHRoZSBxdWV1ZSBpcyBlbXB0eSwgYnV0IGl0\nIGNvdWxkIG1lYW4gdGhhdCBzb21lIHByb21pc2VzIGhhdmVuJ3QgY29tcGxl\ndGVkIHlldC4KCglAcmV0dXJucyBBIHByb21pc2UgdGhhdCBzZXR0bGVzIHdo\nZW4gdGhlIHF1ZXVlIGJlY29tZXMgZW1wdHksIGFuZCBhbGwgcHJvbWlzZXMg\naGF2ZSBjb21wbGV0ZWQ7IGBxdWV1ZS5zaXplID09PSAwICYmIHF1ZXVlLnBl\nbmRpbmcgPT09IDBgLgoJKi8KCWFzeW5jIG9uSWRsZSgpOiBQcm9taXNlPHZv\naWQ+IHsKCQkvLyBJbnN0YW50bHkgcmVzb2x2ZSBpZiBub25lIHBlbmRpbmcg\nYW5kIGlmIG5vdGhpbmcgZWxzZSBpcyBxdWV1ZWQKCQlpZiAodGhpcy4jcGVu\nZGluZyA9PT0gMCAmJiB0aGlzLiNxdWV1ZS5zaXplID09PSAwKSB7CgkJCXJl\ndHVybjsKCQl9CgoJCWF3YWl0IHRoaXMuI29uRXZlbnQoJ2lkbGUnKTsKCX0K\nCgkvKioKCVRoZSBkaWZmZXJlbmNlIHdpdGggYC5vbklkbGVgIGlzIHRoYXQg\nYC5vblBlbmRpbmdaZXJvYCBvbmx5IHdhaXRzIGZvciBjdXJyZW50bHkgcnVu\nbmluZyB0YXNrcyB0byBmaW5pc2gsIGlnbm9yaW5nIHF1ZXVlZCB0YXNrcy4K\nCglAcmV0dXJucyBBIHByb21pc2UgdGhhdCBzZXR0bGVzIHdoZW4gYWxsIGN1\ncnJlbnRseSBydW5uaW5nIHRhc2tzIGhhdmUgY29tcGxldGVkOyBgcXVldWUu\ncGVuZGluZyA9PT0gMGAuCgkqLwoJYXN5bmMgb25QZW5kaW5nWmVybygpOiBQ\ncm9taXNlPHZvaWQ+IHsKCQlpZiAodGhpcy4jcGVuZGluZyA9PT0gMCkgewoJ\nCQlyZXR1cm47CgkJfQoKCQlhd2FpdCB0aGlzLiNvbkV2ZW50KCdwZW5kaW5n\nWmVybycpOwoJfQoKCS8qKgoJQHJldHVybnMgQSBwcm9taXNlIHRoYXQgc2V0\ndGxlcyB3aGVuIHRoZSBxdWV1ZSBiZWNvbWVzIHJhdGUtbGltaXRlZCBkdWUg\ndG8gaW50ZXJ2YWxDYXAuCgkqLwoJYXN5bmMgb25SYXRlTGltaXQoKTogUHJv\nbWlzZTx2b2lkPiB7CgkJaWYgKHRoaXMuaXNSYXRlTGltaXRlZCkgewoJCQly\nZXR1cm47CgkJfQoKCQlhd2FpdCB0aGlzLiNvbkV2ZW50KCdyYXRlTGltaXQn\nKTsKCX0KCgkvKioKCUByZXR1cm5zIEEgcHJvbWlzZSB0aGF0IHNldHRsZXMg\nd2hlbiB0aGUgcXVldWUgaXMgbm8gbG9uZ2VyIHJhdGUtbGltaXRlZC4KCSov\nCglhc3luYyBvblJhdGVMaW1pdENsZWFyZWQoKTogUHJvbWlzZTx2b2lkPiB7\nCgkJaWYgKCF0aGlzLmlzUmF0ZUxpbWl0ZWQpIHsKCQkJcmV0dXJuOwoJCX0K\nCgkJYXdhaXQgdGhpcy4jb25FdmVudCgncmF0ZUxpbWl0Q2xlYXJlZCcpOwoJ\nfQoKCS8qKgoJQHJldHVybnMgQSBwcm9taXNlIHRoYXQgcmVqZWN0cyB3aGVu\nIGFueSB0YXNrIGluIHRoZSBxdWV1ZSBlcnJvcnMuCgoJVXNlIHdpdGggYFBy\nb21pc2UucmFjZShbcXVldWUub25FcnJvcigpLCBxdWV1ZS5vbklkbGUoKV0p\nYCB0byBmYWlsIGZhc3Qgb24gdGhlIGZpcnN0IGVycm9yIHdoaWxlIHN0aWxs\nIHJlc29sdmluZyBub3JtYWxseSB3aGVuIHRoZSBxdWV1ZSBnb2VzIGlkbGUu\nCgoJSW1wb3J0YW50OiBUaGUgcHJvbWlzZSByZXR1cm5lZCBieSBgYWRkKClg\nIHN0aWxsIHJlamVjdHMuIFlvdSBtdXN0IGhhbmRsZSBlYWNoIGBhZGQoKWAg\ncHJvbWlzZSAoZm9yIGV4YW1wbGUsIGAuY2F0Y2goKCkgPT4ge30pYCkgdG8g\nYXZvaWQgdW5oYW5kbGVkIHJlamVjdGlvbnMuCgoJQGV4YW1wbGUKCWBgYAoJ\naW1wb3J0IFBRdWV1ZSBmcm9tICdwLXF1ZXVlJzsKCgljb25zdCBxdWV1ZSA9\nIG5ldyBQUXVldWUoe2NvbmN1cnJlbmN5OiAyfSk7CgoJcXVldWUuYWRkKCgp\nID0+IGZldGNoRGF0YSgxKSkuY2F0Y2goKCkgPT4ge30pOwoJcXVldWUuYWRk\nKCgpID0+IGZldGNoRGF0YSgyKSkuY2F0Y2goKCkgPT4ge30pOwoJcXVldWUu\nYWRkKCgpID0+IGZldGNoRGF0YSgzKSkuY2F0Y2goKCkgPT4ge30pOwoKCS8v\nIFN0b3AgcHJvY2Vzc2luZyBvbiBmaXJzdCBlcnJvcgoJdHJ5IHsKCQlhd2Fp\ndCBQcm9taXNlLnJhY2UoWwoJCQlxdWV1ZS5vbkVycm9yKCksCgkJCXF1ZXVl\nLm9uSWRsZSgpCgkJXSk7Cgl9IGNhdGNoIChlcnJvcikgewoJCXF1ZXVlLnBh\ndXNlKCk7IC8vIFN0b3AgcHJvY2Vzc2luZyByZW1haW5pbmcgdGFza3MKCQlj\nb25zb2xlLmVycm9yKCdRdWV1ZSBmYWlsZWQ6JywgZXJyb3IpOwoJfQoJYGBg\nCgkqLwoJLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0\nLWVzbGludC9wcm9taXNlLWZ1bmN0aW9uLWFzeW5jCglvbkVycm9yKCk6IFBy\nb21pc2U8bmV2ZXI+IHsKCQlyZXR1cm4gbmV3IFByb21pc2U8bmV2ZXI+KChf\ncmVzb2x2ZSwgcmVqZWN0KSA9PiB7CgkJCWNvbnN0IGhhbmRsZUVycm9yID0g\nKGVycm9yOiB1bmtub3duKSA9PiB7CgkJCQl0aGlzLm9mZignZXJyb3InLCBo\nYW5kbGVFcnJvcik7CgkJCQlyZWplY3QoZXJyb3IpOwoJCQl9OwoKCQkJdGhp\ncy5vbignZXJyb3InLCBoYW5kbGVFcnJvcik7CgkJfSk7Cgl9CgoJYXN5bmMg\nI29uRXZlbnQoZXZlbnQ6IEV2ZW50TmFtZSwgZmlsdGVyPzogKCkgPT4gYm9v\nbGVhbik6IFByb21pc2U8dm9pZD4gewoJCXJldHVybiBuZXcgUHJvbWlzZShy\nZXNvbHZlID0+IHsKCQkJY29uc3QgbGlzdGVuZXIgPSAoKSA9PiB7CgkJCQlp\nZiAoZmlsdGVyICYmICFmaWx0ZXIoKSkgewoJCQkJCXJldHVybjsKCQkJCX0K\nCgkJCQl0aGlzLm9mZihldmVudCwgbGlzdGVuZXIpOwoJCQkJcmVzb2x2ZSgp\nOwoJCQl9OwoKCQkJdGhpcy5vbihldmVudCwgbGlzdGVuZXIpOwoJCX0pOwoJ\nfQoKCS8qKgoJU2l6ZSBvZiB0aGUgcXVldWUsIHRoZSBudW1iZXIgb2YgcXVl\ndWVkIGl0ZW1zIHdhaXRpbmcgdG8gcnVuLgoJKi8KCWdldCBzaXplKCk6IG51\nbWJlciB7CgkJcmV0dXJuIHRoaXMuI3F1ZXVlLnNpemU7Cgl9CgoJLyoqCglT\naXplIG9mIHRoZSBxdWV1ZSwgZmlsdGVyZWQgYnkgdGhlIGdpdmVuIG9wdGlv\nbnMuCgoJRm9yIGV4YW1wbGUsIHRoaXMgY2FuIGJlIHVzZWQgdG8gZmluZCB0\naGUgbnVtYmVyIG9mIGl0ZW1zIHJlbWFpbmluZyBpbiB0aGUgcXVldWUgd2l0\naCBhIHNwZWNpZmljIHByaW9yaXR5IGxldmVsLgoJKi8KCXNpemVCeShvcHRp\nb25zOiBSZWFkb25seTxQYXJ0aWFsPEVucXVldWVPcHRpb25zVHlwZT4+KTog\nbnVtYmVyIHsKCQkvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgdW5pY29y\nbi9uby1hcnJheS1jYWxsYmFjay1yZWZlcmVuY2UKCQlyZXR1cm4gdGhpcy4j\ncXVldWUuZmlsdGVyKG9wdGlvbnMpLmxlbmd0aDsKCX0KCgkvKioKCU51bWJl\nciBvZiBydW5uaW5nIGl0ZW1zIChubyBsb25nZXIgaW4gdGhlIHF1ZXVlKS4K\nCSovCglnZXQgcGVuZGluZygpOiBudW1iZXIgewoJCXJldHVybiB0aGlzLiNw\nZW5kaW5nOwoJfQoKCS8qKgoJV2hldGhlciB0aGUgcXVldWUgaXMgY3VycmVu\ndGx5IHBhdXNlZC4KCSovCglnZXQgaXNQYXVzZWQoKTogYm9vbGVhbiB7CgkJ\ncmV0dXJuIHRoaXMuI2lzUGF1c2VkOwoJfQoKCSNzZXR1cFJhdGVMaW1pdFRy\nYWNraW5nKCk6IHZvaWQgewoJCS8vIE9ubHkgc2NoZWR1bGUgdXBkYXRlcyB3\naGVuIHJhdGUgbGltaXRpbmcgaXMgZW5hYmxlZAoJCWlmICh0aGlzLiNpc0lu\ndGVydmFsSWdub3JlZCkgewoJCQlyZXR1cm47CgkJfQoKCQkvLyBXaXJlIHVw\nIHRvIGxpZmVjeWNsZSBldmVudHMgdGhhdCBhZmZlY3QgcmF0ZSBsaW1pdCBz\ndGF0ZQoJCS8vIE9ubHkgJ2FkZCcgYW5kICduZXh0JyBjYW4gYWN0dWFsbHkg\nY2hhbmdlIHJhdGUgbGltaXQgc3RhdGUKCQl0aGlzLm9uKCdhZGQnLCAoKSA9\nPiB7CgkJCWlmICh0aGlzLiNxdWV1ZS5zaXplID4gMCkgewoJCQkJdGhpcy4j\nc2NoZWR1bGVSYXRlTGltaXRVcGRhdGUoKTsKCQkJfQoJCX0pOwoKCQl0aGlz\nLm9uKCduZXh0JywgKCkgPT4gewoJCQl0aGlzLiNzY2hlZHVsZVJhdGVMaW1p\ndFVwZGF0ZSgpOwoJCX0pOwoJfQoKCSNzY2hlZHVsZVJhdGVMaW1pdFVwZGF0\nZSgpOiB2b2lkIHsKCQkvLyBTa2lwIGlmIHJhdGUgbGltaXRpbmcgaXMgbm90\nIGVuYWJsZWQgb3IgYWxyZWFkeSBzY2hlZHVsZWQKCQlpZiAodGhpcy4jaXNJ\nbnRlcnZhbElnbm9yZWQgfHwgdGhpcy4jcmF0ZUxpbWl0Rmx1c2hTY2hlZHVs\nZWQpIHsKCQkJcmV0dXJuOwoJCX0KCgkJdGhpcy4jcmF0ZUxpbWl0Rmx1c2hT\nY2hlZHVsZWQgPSB0cnVlOwoJCXF1ZXVlTWljcm90YXNrKCgpID0+IHsKCQkJ\ndGhpcy4jcmF0ZUxpbWl0Rmx1c2hTY2hlZHVsZWQgPSBmYWxzZTsKCQkJdGhp\ncy4jdXBkYXRlUmF0ZUxpbWl0U3RhdGUoKTsKCQl9KTsKCX0KCgkjcm9sbGJh\nY2tJbnRlcnZhbENvbnN1bXB0aW9uKCk6IHZvaWQgewoJCWlmICh0aGlzLiNp\nc0ludGVydmFsSWdub3JlZCkgewoJCQlyZXR1cm47CgkJfQoKCQl0aGlzLiNy\nb2xsYmFja0ludGVydmFsU2xvdCgpOwoJCXRoaXMuI3NjaGVkdWxlUmF0ZUxp\nbWl0VXBkYXRlKCk7Cgl9CgoJI3VwZGF0ZVJhdGVMaW1pdFN0YXRlKCk6IHZv\naWQgewoJCWNvbnN0IHByZXZpb3VzID0gdGhpcy4jcmF0ZUxpbWl0ZWRJbklu\ndGVydmFsOwoKCQkvLyBFYXJseSBleGl0IGlmIHJhdGUgbGltaXRpbmcgaXMg\nZGlzYWJsZWQgb3IgcXVldWUgaXMgZW1wdHkKCQlpZiAodGhpcy4jaXNJbnRl\ncnZhbElnbm9yZWQgfHwgdGhpcy4jcXVldWUuc2l6ZSA9PT0gMCkgewoJCQlp\nZiAocHJldmlvdXMpIHsKCQkJCXRoaXMuI3JhdGVMaW1pdGVkSW5JbnRlcnZh\nbCA9IGZhbHNlOwoJCQkJdGhpcy5lbWl0KCdyYXRlTGltaXRDbGVhcmVkJyk7\nCgkJCX0KCgkJCXJldHVybjsKCQl9CgoJCS8vIEdldCB0aGUgY3VycmVudCBj\nb3VudCBiYXNlZCBvbiBtb2RlCgkJbGV0IGNvdW50OiBudW1iZXI7CgkJaWYg\nKHRoaXMuI3N0cmljdCkgewoJCQljb25zdCBub3cgPSBEYXRlLm5vdygpOwoJ\nCQl0aGlzLiNjbGVhbnVwU3RyaWN0VGlja3Mobm93KTsKCQkJY291bnQgPSB0\naGlzLiNnZXRBY3RpdmVUaWNrc0NvdW50KCk7CgkJfSBlbHNlIHsKCQkJY291\nbnQgPSB0aGlzLiNpbnRlcnZhbENvdW50OwoJCX0KCgkJY29uc3Qgc2hvdWxk\nQmVSYXRlTGltaXRlZCA9IGNvdW50ID49IHRoaXMuI2ludGVydmFsQ2FwOwoK\nCQlpZiAoc2hvdWxkQmVSYXRlTGltaXRlZCAhPT0gcHJldmlvdXMpIHsKCQkJ\ndGhpcy4jcmF0ZUxpbWl0ZWRJbkludGVydmFsID0gc2hvdWxkQmVSYXRlTGlt\naXRlZDsKCQkJdGhpcy5lbWl0KHNob3VsZEJlUmF0ZUxpbWl0ZWQgPyAncmF0\nZUxpbWl0JyA6ICdyYXRlTGltaXRDbGVhcmVkJyk7CgkJfQoJfQoKCS8qKgoJ\nV2hldGhlciB0aGUgcXVldWUgaXMgY3VycmVudGx5IHJhdGUtbGltaXRlZCBk\ndWUgdG8gaW50ZXJ2YWxDYXAuCgkqLwoJZ2V0IGlzUmF0ZUxpbWl0ZWQoKTog\nYm9vbGVhbiB7CgkJcmV0dXJuIHRoaXMuI3JhdGVMaW1pdGVkSW5JbnRlcnZh\nbDsKCX0KCgkvKioKCVdoZXRoZXIgdGhlIHF1ZXVlIGlzIHNhdHVyYXRlZC4g\nUmV0dXJucyBgdHJ1ZWAgd2hlbjoKCS0gQWxsIGNvbmN1cnJlbmN5IHNsb3Rz\nIGFyZSBvY2N1cGllZCBhbmQgdGFza3MgYXJlIHdhaXRpbmcsIE9SCgktIFRo\nZSBxdWV1ZSBpcyByYXRlLWxpbWl0ZWQgYW5kIHRhc2tzIGFyZSB3YWl0aW5n\nCgoJVXNlZnVsIGZvciBkZXRlY3RpbmcgYmFja3ByZXNzdXJlIGFuZCBwb3Rl\nbnRpYWwgaGFuZ2luZyB0YXNrcy4KCglgYGBqcwoJaW1wb3J0IFBRdWV1ZSBm\ncm9tICdwLXF1ZXVlJzsKCgljb25zdCBxdWV1ZSA9IG5ldyBQUXVldWUoe2Nv\nbmN1cnJlbmN5OiAyfSk7CgoJLy8gQmFja3ByZXNzdXJlIGhhbmRsaW5nCglp\nZiAocXVldWUuaXNTYXR1cmF0ZWQpIHsKCQljb25zb2xlLmxvZygnUXVldWUg\naXMgc2F0dXJhdGVkLCB3YWl0aW5nIGZvciBjYXBhY2l0eS4uLicpOwoJCWF3\nYWl0IHF1ZXVlLm9uU2l6ZUxlc3NUaGFuKHF1ZXVlLmNvbmN1cnJlbmN5KTsK\nCX0KCgkvLyBNb25pdG9yaW5nIGZvciBzdHVjayB0YXNrcwoJc2V0SW50ZXJ2\nYWwoKCkgPT4gewoJCWlmIChxdWV1ZS5pc1NhdHVyYXRlZCkgewoJCQljb25z\nb2xlLndhcm4oYFF1ZXVlIHNhdHVyYXRlZDogJHtxdWV1ZS5wZW5kaW5nfSBy\ndW5uaW5nLCAke3F1ZXVlLnNpemV9IHdhaXRpbmdgKTsKCQl9Cgl9LCA2MDAw\nMCk7CglgYGAKCSovCglnZXQgaXNTYXR1cmF0ZWQoKTogYm9vbGVhbiB7CgkJ\ncmV0dXJuICh0aGlzLiNwZW5kaW5nID09PSB0aGlzLiNjb25jdXJyZW5jeSAm\nJiB0aGlzLiNxdWV1ZS5zaXplID4gMCkKCQkJfHwgKHRoaXMuaXNSYXRlTGlt\naXRlZCAmJiB0aGlzLiNxdWV1ZS5zaXplID4gMCk7Cgl9CgoJLyoqCglUaGUg\ndGFza3MgY3VycmVudGx5IGJlaW5nIGV4ZWN1dGVkLiBFYWNoIHRhc2sgaW5j\nbHVkZXMgaXRzIGBpZGAsIGBwcmlvcml0eWAsIGBzdGFydFRpbWVgLCBhbmQg\nYHRpbWVvdXRgIChpZiBzZXQpLgoKCVJldHVybnMgYW4gYXJyYXkgb2YgdGFz\nayBpbmZvIG9iamVjdHMuCgoJYGBganMKCWltcG9ydCBQUXVldWUgZnJvbSAn\ncC1xdWV1ZSc7CgoJY29uc3QgcXVldWUgPSBuZXcgUFF1ZXVlKHtjb25jdXJy\nZW5jeTogMn0pOwoKCS8vIEFkZCB0YXNrcyB3aXRoIElEcyBmb3IgYmV0dGVy\nIGRlYnVnZ2luZwoJcXVldWUuYWRkKCgpID0+IGZldGNoVXNlcigxMjMpLCB7\naWQ6ICd1c2VyLTEyMyd9KTsKCXF1ZXVlLmFkZCgoKSA9PiBmZXRjaFBvc3Rz\nKDQ1NiksIHtpZDogJ3Bvc3RzLTQ1NicsIHByaW9yaXR5OiAxfSk7CgoJLy8g\nQ2hlY2sgd2hhdCdzIHJ1bm5pbmcKCWNvbnNvbGUubG9nKHF1ZXVlLnJ1bm5p\nbmdUYXNrcyk7CgkvLyA9PiBbewoJLy8gICBpZDogJ3VzZXItMTIzJywKCS8v\nICAgcHJpb3JpdHk6IDAsCgkvLyAgIHN0YXJ0VGltZTogMTc1OTI1MzAwMTcx\nNiwKCS8vICAgdGltZW91dDogdW5kZWZpbmVkCgkvLyB9LCB7CgkvLyAgIGlk\nOiAncG9zdHMtNDU2JywKCS8vICAgcHJpb3JpdHk6IDEsCgkvLyAgIHN0YXJ0\nVGltZTogMTc1OTI1MzAwMTkxNiwKCS8vICAgdGltZW91dDogdW5kZWZpbmVk\nCgkvLyB9XQoJYGBgCgkqLwoJZ2V0IHJ1bm5pbmdUYXNrcygpOiBSZWFkb25s\neUFycmF5PHsKCQlyZWFkb25seSBpZD86IHN0cmluZzsKCQlyZWFkb25seSBw\ncmlvcml0eTogbnVtYmVyOwoJCXJlYWRvbmx5IHN0YXJ0VGltZTogbnVtYmVy\nOwoJCXJlYWRvbmx5IHRpbWVvdXQ/OiBudW1iZXI7Cgl9PiB7CgkJLy8gUmV0\ndXJuIGZyZXNoIGFycmF5IHdpdGggZnJlc2ggb2JqZWN0cyB0byBwcmV2ZW50\nIG11dGF0aW9ucwoJCXJldHVybiBbLi4udGhpcy4jcnVubmluZ1Rhc2tzLnZh\nbHVlcygpXS5tYXAodGFzayA9PiAoey4uLnRhc2t9KSk7Cgl9Cn0KCmV4cG9y\ndCB0eXBlIHtRdWV1ZX0gZnJvbSAnLi9xdWV1ZS5qcyc7CmV4cG9ydCB7dHlw\nZSBRdWV1ZUFkZE9wdGlvbnMsIHR5cGUgT3B0aW9uc30gZnJvbSAnLi9vcHRp\nb25zLmpzJzsKCi8qKgpFcnJvciB0aHJvd24gd2hlbiBhIHRhc2sgdGltZXMg\nb3V0LgoKQGV4YW1wbGUKYGBgCmltcG9ydCBQUXVldWUsIHtUaW1lb3V0RXJy\nb3J9IGZyb20gJ3AtcXVldWUnOwoKY29uc3QgcXVldWUgPSBuZXcgUFF1ZXVl\nKHt0aW1lb3V0OiAxMDAwfSk7Cgp0cnkgewoJYXdhaXQgcXVldWUuYWRkKCgp\nID0+IHNvbWVUYXNrKCkpOwp9IGNhdGNoIChlcnJvcikgewoJaWYgKGVycm9y\nIGluc3RhbmNlb2YgVGltZW91dEVycm9yKSB7CgkJY29uc29sZS5sb2coJ1Rh\nc2sgdGltZWQgb3V0Jyk7Cgl9Cn0KYGBgCiovCmV4cG9ydCB7VGltZW91dEVy\ncm9yfSBmcm9tICdwLXRpbWVvdXQnOwo=\n", "encoding": "base64", "_links": {"self": "https://api.github.com/repos/sindresorhus/p-queue/contents/source/index.ts?ref=main", "git": "https://api.github.com/repos/sindresorhus/p-queue/git/blobs/a1dbca396feacef167895626f0db2eb76a99cd11", "html": "https://github.com/sindresorhus/p-queue/blob/main/source/index.ts"}}