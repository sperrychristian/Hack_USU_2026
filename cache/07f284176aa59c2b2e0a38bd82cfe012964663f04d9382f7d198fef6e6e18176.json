{"name": "Ky.ts", "path": "source/core/Ky.ts", "sha": "4aaa12b8921a066965fa858e0fcbbbfdc3744f63", "size": 25412, "url": "https://api.github.com/repos/sindresorhus/ky/contents/source/core/Ky.ts?ref=main", "html_url": "https://github.com/sindresorhus/ky/blob/main/source/core/Ky.ts", "git_url": "https://api.github.com/repos/sindresorhus/ky/git/blobs/4aaa12b8921a066965fa858e0fcbbbfdc3744f63", "download_url": "https://raw.githubusercontent.com/sindresorhus/ky/main/source/core/Ky.ts", "type": "file", "content": "aW1wb3J0IHtIVFRQRXJyb3J9IGZyb20gJy4uL2Vycm9ycy9IVFRQRXJyb3Iu\nanMnOwppbXBvcnQge05vbkVycm9yfSBmcm9tICcuLi9lcnJvcnMvTm9uRXJy\nb3IuanMnOwppbXBvcnQge0ZvcmNlUmV0cnlFcnJvcn0gZnJvbSAnLi4vZXJy\nb3JzL0ZvcmNlUmV0cnlFcnJvci5qcyc7CmltcG9ydCB7VGltZW91dEVycm9y\nfSBmcm9tICcuLi9lcnJvcnMvVGltZW91dEVycm9yLmpzJzsKaW1wb3J0IHR5\ncGUgewoJSW5wdXQsCglJbnRlcm5hbE9wdGlvbnMsCglOb3JtYWxpemVkT3B0\naW9ucywKCU9wdGlvbnMsCglTZWFyY2hQYXJhbXNJbml0LAoJU2VhcmNoUGFy\nYW1zT3B0aW9uLAp9IGZyb20gJy4uL3R5cGVzL29wdGlvbnMuanMnOwppbXBv\ncnQge3R5cGUgUmVzcG9uc2VQcm9taXNlfSBmcm9tICcuLi90eXBlcy9SZXNw\nb25zZVByb21pc2UuanMnOwppbXBvcnQge3N0cmVhbVJlcXVlc3QsIHN0cmVh\nbVJlc3BvbnNlfSBmcm9tICcuLi91dGlscy9ib2R5LmpzJzsKaW1wb3J0IHtt\nZXJnZUhlYWRlcnMsIG1lcmdlSG9va3N9IGZyb20gJy4uL3V0aWxzL21lcmdl\nLmpzJzsKaW1wb3J0IHtub3JtYWxpemVSZXF1ZXN0TWV0aG9kLCBub3JtYWxp\nemVSZXRyeU9wdGlvbnN9IGZyb20gJy4uL3V0aWxzL25vcm1hbGl6ZS5qcyc7\nCmltcG9ydCB0aW1lb3V0LCB7dHlwZSBUaW1lb3V0T3B0aW9uc30gZnJvbSAn\nLi4vdXRpbHMvdGltZW91dC5qcyc7CmltcG9ydCBkZWxheSBmcm9tICcuLi91\ndGlscy9kZWxheS5qcyc7CmltcG9ydCB7dHlwZSBPYmplY3RFbnRyaWVzfSBm\ncm9tICcuLi91dGlscy90eXBlcy5qcyc7CmltcG9ydCB7ZmluZFVua25vd25P\ncHRpb25zLCBoYXNTZWFyY2hQYXJhbWV0ZXJzfSBmcm9tICcuLi91dGlscy9v\ncHRpb25zLmpzJzsKaW1wb3J0IHtpc0hUVFBFcnJvciwgaXNUaW1lb3V0RXJy\nb3J9IGZyb20gJy4uL3V0aWxzL3R5cGUtZ3VhcmRzLmpzJzsKaW1wb3J0IHsK\nCW1heFNhZmVUaW1lb3V0LAoJcmVzcG9uc2VUeXBlcywKCXN0b3AsCglSZXRy\neU1hcmtlciwKCXN1cHBvcnRzQWJvcnRDb250cm9sbGVyLAoJc3VwcG9ydHNB\nYm9ydFNpZ25hbCwKCXN1cHBvcnRzRm9ybURhdGEsCglzdXBwb3J0c1Jlc3Bv\nbnNlU3RyZWFtcywKCXN1cHBvcnRzUmVxdWVzdFN0cmVhbXMsCn0gZnJvbSAn\nLi9jb25zdGFudHMuanMnOwoKY29uc3QgbWF4RXJyb3JSZXNwb25zZUJvZHlT\naXplID0gMTAgKiAxMDI0ICogMTAyNDsKCmNvbnN0IGNyZWF0ZVRleHREZWNv\nZGVyID0gKGNvbnRlbnRUeXBlOiBzdHJpbmcpOiBUZXh0RGVjb2RlciA9PiB7\nCgljb25zdCBtYXRjaCA9IC87XHMqY2hhcnNldFxzKj1ccyooPzoiKFteIl0r\nKSJ8KFteOyxcc10rKSkvaS5leGVjKGNvbnRlbnRUeXBlKTsKCWNvbnN0IGNo\nYXJzZXQgPSBtYXRjaD8uWzFdID8/IG1hdGNoPy5bMl07CglpZiAoY2hhcnNl\ndCkgewoJCXRyeSB7CgkJCXJldHVybiBuZXcgVGV4dERlY29kZXIoY2hhcnNl\ndCk7CgkJfSBjYXRjaCB7fQoJfQoKCXJldHVybiBuZXcgVGV4dERlY29kZXIo\nKTsKfTsKCmV4cG9ydCBjbGFzcyBLeSB7CglzdGF0aWMgY3JlYXRlKGlucHV0\nOiBJbnB1dCwgb3B0aW9uczogT3B0aW9ucyk6IFJlc3BvbnNlUHJvbWlzZSB7\nCgkJY29uc3Qga3kgPSBuZXcgS3koaW5wdXQsIG9wdGlvbnMpOwoKCQljb25z\ndCBmdW5jdGlvbl8gPSBhc3luYyAoKTogUHJvbWlzZTxSZXNwb25zZT4gPT4g\newoJCQlpZiAodHlwZW9mIGt5LiNvcHRpb25zLnRpbWVvdXQgPT09ICdudW1i\nZXInICYmIGt5LiNvcHRpb25zLnRpbWVvdXQgPiBtYXhTYWZlVGltZW91dCkg\newoJCQkJdGhyb3cgbmV3IFJhbmdlRXJyb3IoYFRoZSBcYHRpbWVvdXRcYCBv\ncHRpb24gY2Fubm90IGJlIGdyZWF0ZXIgdGhhbiAke21heFNhZmVUaW1lb3V0\nfWApOwoJCQl9CgoJCQkvLyBUcmFjayBzdGFydCB0aW1lIGZvciB0b3RhbCB0\naW1lb3V0IGFjcm9zcyByZXRyaWVzCgkJCWlmIChreS4jc3RhcnRUaW1lID09\nPSB1bmRlZmluZWQgJiYgdHlwZW9mIGt5LiNvcHRpb25zLnRpbWVvdXQgPT09\nICdudW1iZXInKSB7CgkJCQlreS4jc3RhcnRUaW1lID0ga3kuI2dldEN1cnJl\nbnRUaW1lKCk7CgkJCX0KCgkJCS8vIERlbGF5IHRoZSBmZXRjaCBzbyB0aGF0\nIGJvZHkgbWV0aG9kIHNob3J0Y3V0cyBjYW4gc2V0IHRoZSBBY2NlcHQgaGVh\nZGVyCgkJCWF3YWl0IFByb21pc2UucmVzb2x2ZSgpOwoJCQlsZXQgcmVzcG9u\nc2UgPSBhd2FpdCBreS4jZmV0Y2goKTsKCgkJCWZvciAoY29uc3QgaG9vayBv\nZiBreS4jb3B0aW9ucy5ob29rcy5hZnRlclJlc3BvbnNlKSB7CgkJCQkvLyBD\nbG9uZSB0aGUgcmVzcG9uc2UgYmVmb3JlIHBhc3NpbmcgdG8gaG9vayBzbyB3\nZSBjYW4gY2FuY2VsIGl0IGlmIG5lZWRlZAoJCQkJY29uc3QgY2xvbmVkUmVz\ncG9uc2UgPSBreS4jZGVjb3JhdGVSZXNwb25zZShyZXNwb25zZS5jbG9uZSgp\nKTsKCgkJCQlsZXQgbW9kaWZpZWRSZXNwb25zZTsKCQkJCXRyeSB7CgkJCQkJ\nLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWF3YWl0LWluLWxvb3AK\nCQkJCQltb2RpZmllZFJlc3BvbnNlID0gYXdhaXQgaG9vayh7CgkJCQkJCXJl\ncXVlc3Q6IGt5LnJlcXVlc3QsCgkJCQkJCW9wdGlvbnM6IGt5LiNnZXROb3Jt\nYWxpemVkT3B0aW9ucygpLAoJCQkJCQlyZXNwb25zZTogY2xvbmVkUmVzcG9u\nc2UsCgkJCQkJCXJldHJ5Q291bnQ6IGt5LiNyZXRyeUNvdW50LAoJCQkJCX0p\nOwoJCQkJfSBjYXRjaCAoZXJyb3IpIHsKCQkJCQkvLyBDYW5jZWwgYm90aCBy\nZXNwb25zZXMgdG8gcHJldmVudCBtZW1vcnkgbGVha3Mgd2hlbiBob29rIHRo\ncm93cwoJCQkJCWt5LiNjYW5jZWxSZXNwb25zZUJvZHkoY2xvbmVkUmVzcG9u\nc2UpOwoJCQkJCWt5LiNjYW5jZWxSZXNwb25zZUJvZHkocmVzcG9uc2UpOwoJ\nCQkJCXRocm93IGVycm9yOwoJCQkJfQoKCQkJCWlmIChtb2RpZmllZFJlc3Bv\nbnNlIGluc3RhbmNlb2YgUmV0cnlNYXJrZXIpIHsKCQkJCQkvLyBDYW5jZWwg\nYm90aCB0aGUgY2xvbmVkIHJlc3BvbnNlIHBhc3NlZCB0byB0aGUgaG9vayBh\nbmQgdGhlIGN1cnJlbnQgcmVzcG9uc2UgdG8gcHJldmVudCByZXNvdXJjZSBs\nZWFrcyAoZXNwZWNpYWxseSBpbXBvcnRhbnQgaW4gRGVuby9CdW4pLgoJCQkJ\nCS8vIERvIG5vdCBhd2FpdCBjYW5jZWxsYXRpb24gc2luY2UgaG9va3MgY2Fu\nIGNsb25lIHRoZSByZXNwb25zZSwgbGVhdmluZyBleHRyYSB0ZWUgYnJhbmNo\nZXMgdGhhdCBrZWVwIGNhbmNlbCBwcm9taXNlcyBwZW5kaW5nIHBlciB0aGUg\nU3RyZWFtcyBzcGVjLgoJCQkJCWt5LiNjYW5jZWxSZXNwb25zZUJvZHkoY2xv\nbmVkUmVzcG9uc2UpOwoJCQkJCWt5LiNjYW5jZWxSZXNwb25zZUJvZHkocmVz\ncG9uc2UpOwoJCQkJCXRocm93IG5ldyBGb3JjZVJldHJ5RXJyb3IobW9kaWZp\nZWRSZXNwb25zZS5vcHRpb25zKTsKCQkJCX0KCgkJCQkvLyBEZXRlcm1pbmUg\nd2hpY2ggcmVzcG9uc2UgdG8gdXNlIGdvaW5nIGZvcndhcmQKCQkJCWNvbnN0\nIG5leHRSZXNwb25zZSA9IG1vZGlmaWVkUmVzcG9uc2UgaW5zdGFuY2VvZiBn\nbG9iYWxUaGlzLlJlc3BvbnNlID8gbW9kaWZpZWRSZXNwb25zZSA6IHJlc3Bv\nbnNlOwoKCQkJCS8vIENhbmNlbCBhbnkgcmVzcG9uc2UgYm9kaWVzIHdlIHdv\nbid0IHVzZSB0byBwcmV2ZW50IG1lbW9yeSBsZWFrcy4KCQkJCS8vIFVzZXMg\nZmlyZS1hbmQtZm9yZ2V0IHNpbmNlIGhvb2tzIG1heSBoYXZlIGNsb25lZCB0\naGUgcmVzcG9uc2UsIGNyZWF0aW5nIHRlZSBicmFuY2hlcyB0aGF0IGJsb2Nr\nIGNhbmNlbGxhdGlvbi4KCQkJCWlmIChjbG9uZWRSZXNwb25zZSAhPT0gbmV4\ndFJlc3BvbnNlKSB7CgkJCQkJa3kuI2NhbmNlbFJlc3BvbnNlQm9keShjbG9u\nZWRSZXNwb25zZSk7CgkJCQl9CgoJCQkJaWYgKHJlc3BvbnNlICE9PSBuZXh0\nUmVzcG9uc2UpIHsKCQkJCQlreS4jY2FuY2VsUmVzcG9uc2VCb2R5KHJlc3Bv\nbnNlKTsKCQkJCX0KCgkJCQlyZXNwb25zZSA9IG5leHRSZXNwb25zZTsKCQkJ\nfQoKCQkJa3kuI2RlY29yYXRlUmVzcG9uc2UocmVzcG9uc2UpOwoKCQkJaWYg\nKCFyZXNwb25zZS5vayAmJiAoCgkJCQl0eXBlb2Yga3kuI29wdGlvbnMudGhy\nb3dIdHRwRXJyb3JzID09PSAnZnVuY3Rpb24nCgkJCQkJPyBreS4jb3B0aW9u\ncy50aHJvd0h0dHBFcnJvcnMocmVzcG9uc2Uuc3RhdHVzKQoJCQkJCToga3ku\nI29wdGlvbnMudGhyb3dIdHRwRXJyb3JzCgkJCSkpIHsKCQkJCWNvbnN0IGVy\ncm9yID0gbmV3IEhUVFBFcnJvcihyZXNwb25zZSwga3kucmVxdWVzdCwga3ku\nI2dldE5vcm1hbGl6ZWRPcHRpb25zKCkpOwoJCQkJZXJyb3IuZGF0YSA9IGF3\nYWl0IGt5LiNnZXRSZXNwb25zZURhdGEocmVzcG9uc2UpOwoKCQkJCXRocm93\nIGVycm9yOwoJCQl9CgoJCQkvLyBJZiBgb25Eb3dubG9hZFByb2dyZXNzYCBp\ncyBwYXNzZWQsIGl0IHVzZXMgdGhlIHN0cmVhbSBBUEkgaW50ZXJuYWxseQoJ\nCQlpZiAoa3kuI29wdGlvbnMub25Eb3dubG9hZFByb2dyZXNzKSB7CgkJCQlp\nZiAodHlwZW9mIGt5LiNvcHRpb25zLm9uRG93bmxvYWRQcm9ncmVzcyAhPT0g\nJ2Z1bmN0aW9uJykgewoJCQkJCXRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBg\nb25Eb3dubG9hZFByb2dyZXNzYCBvcHRpb24gbXVzdCBiZSBhIGZ1bmN0aW9u\nJyk7CgkJCQl9CgoJCQkJaWYgKCFzdXBwb3J0c1Jlc3BvbnNlU3RyZWFtcykg\newoJCQkJCXRocm93IG5ldyBFcnJvcignU3RyZWFtcyBhcmUgbm90IHN1cHBv\ncnRlZCBpbiB5b3VyIGVudmlyb25tZW50LiBgUmVhZGFibGVTdHJlYW1gIGlz\nIG1pc3NpbmcuJyk7CgkJCQl9CgoJCQkJY29uc3QgcHJvZ3Jlc3NSZXNwb25z\nZSA9IHJlc3BvbnNlLmNsb25lKCk7CgkJCQlreS4jY2FuY2VsUmVzcG9uc2VC\nb2R5KHJlc3BvbnNlKTsKCQkJCXJldHVybiBzdHJlYW1SZXNwb25zZShwcm9n\ncmVzc1Jlc3BvbnNlLCBreS4jb3B0aW9ucy5vbkRvd25sb2FkUHJvZ3Jlc3Mp\nOwoJCQl9CgoJCQlyZXR1cm4gcmVzcG9uc2U7CgkJfTsKCgkJLy8gQWx3YXlz\nIHdyYXAgaW4gI3JldHJ5IHRvIGNhdGNoIGZvcmNlZCByZXRyaWVzIGZyb20g\nYWZ0ZXJSZXNwb25zZSBob29rcwoJCS8vIE1ldGhvZCByZXRyaWFiaWxpdHkg\naXMgY2hlY2tlZCBpbiAjY2FsY3VsYXRlUmV0cnlEZWxheSBmb3Igbm9uLWZv\ncmNlZCByZXRyaWVzCgkJY29uc3QgcmVzdWx0ID0gKGFzeW5jICgpID0+IHsK\nCQkJdHJ5IHsKCQkJCXJldHVybiBhd2FpdCBreS4jcmV0cnkoZnVuY3Rpb25f\nKTsKCQkJfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHsKCQkJCS8vIE5vbi1F\ncnJvciB0aHJvd3MgKGUuZy4gdGhyb3duIHN0cmluZ3MpIHBhc3MgdGhyb3Vn\naCB1bmNoYW5nZWQKCQkJCWlmICghKGVycm9yIGluc3RhbmNlb2YgRXJyb3Ip\nKSB7CgkJCQkJdGhyb3cgZXJyb3I7CgkJCQl9CgoJCQkJLy8gRXJyb3JzIHRo\ncm93biBieSBiZWZvcmVSZXRyeSBob29rcyBtdXN0IHByb3BhZ2F0ZSB1bmNo\nYW5nZWQuCgkJCQlpZiAoa3kuI2JlZm9yZVJldHJ5SG9va0Vycm9ycy5oYXMo\nZXJyb3IpKSB7CgkJCQkJdGhyb3cgZXJyb3I7CgkJCQl9CgoJCQkJLy8gI2Nh\nbGN1bGF0ZVJldHJ5RGVsYXkgaW5jcmVtZW50cyAjcmV0cnlDb3VudCBiZWZv\ncmUgZGVjaWRpbmcgd2hldGhlciB0byByZXRyeSwKCQkJCS8vIHNvIHRoZSBj\nb3VudCBpcyBhbHdheXMgMSBoaWdoZXIgdGhhbiB0aGUgbnVtYmVyIG9mIHJl\ndHJpZXMgYWN0dWFsbHkgcGVyZm9ybWVkLgoJCQkJY29uc3QgcmV0cnlDb3Vu\ndCA9IE1hdGgubWF4KDAsIGt5LiNyZXRyeUNvdW50IC0gMSk7CgoJCQkJbGV0\nIHByb2Nlc3NlZEVycm9yOiBFcnJvciA9IGVycm9yOwoJCQkJZm9yIChjb25z\ndCBob29rIG9mIGt5LiNvcHRpb25zLmhvb2tzLmJlZm9yZUVycm9yKSB7CgkJ\nCQkJLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWF3YWl0LWluLWxv\nb3AKCQkJCQlwcm9jZXNzZWRFcnJvciA9IGF3YWl0IGhvb2soewoJCQkJCQll\ncnJvcjogcHJvY2Vzc2VkRXJyb3IsCgkJCQkJCXJldHJ5Q291bnQsCgkJCQkJ\nfSk7CgkJCQl9CgoJCQkJdGhyb3cgcHJvY2Vzc2VkRXJyb3I7CgkJCX0gZmlu\nYWxseSB7CgkJCQljb25zdCBvcmlnaW5hbFJlcXVlc3QgPSBreS4jb3JpZ2lu\nYWxSZXF1ZXN0OwoKCQkJCS8vIElnbm9yZSBjYW5jZWxsYXRpb24gZXJyb3Jz\nIGZyb20gYWxyZWFkeS1sb2NrZWQgb3IgYWxyZWFkeS1jb25zdW1lZCBzdHJl\nYW1zLgoJCQkJa3kuI2NhbmNlbEJvZHkob3JpZ2luYWxSZXF1ZXN0Py5ib2R5\nID8/IHVuZGVmaW5lZCk7CgkJCQkvLyBPbmx5IGNhbmNlbCB0aGUgY3VycmVu\ndCByZXF1ZXN0IGJvZHkgaWYgaXQncyBkaXN0aW5jdCBmcm9tIHRoZSBvcmln\naW5hbCAoaS5lLiBpdCB3YXMgY2xvbmVkIGZvciByZXRyaWVzKS4KCQkJCWlm\nIChreS5yZXF1ZXN0ICE9PSBvcmlnaW5hbFJlcXVlc3QpIHsKCQkJCQlreS4j\nY2FuY2VsQm9keShreS5yZXF1ZXN0LmJvZHkgPz8gdW5kZWZpbmVkKTsKCQkJ\nCX0KCQkJfQoJCX0pKCkgYXMgUmVzcG9uc2VQcm9taXNlOwoKCQlmb3IgKGNv\nbnN0IFt0eXBlLCBtaW1lVHlwZV0gb2YgT2JqZWN0LmVudHJpZXMocmVzcG9u\nc2VUeXBlcykgYXMgT2JqZWN0RW50cmllczx0eXBlb2YgcmVzcG9uc2VUeXBl\ncz4pIHsKCQkJLy8gT25seSBleHBvc2UgYC5ieXRlcygpYCB3aGVuIHRoZSBl\nbnZpcm9ubWVudCBpbXBsZW1lbnRzIGl0LgoJCQlpZiAoCgkJCQl0eXBlID09\nPSAnYnl0ZXMnCgkJCQkmJiB0eXBlb2YgKGdsb2JhbFRoaXMuUmVzcG9uc2U/\nLnByb3RvdHlwZSBhcyB1bmtub3duIGFzIHtieXRlcz86IHVua25vd259KT8u\nYnl0ZXMgIT09ICdmdW5jdGlvbicKCQkJKSB7CgkJCQljb250aW51ZTsKCQkJ\nfQoKCQkJcmVzdWx0W3R5cGVdID0gYXN5bmMgKCkgPT4gewoJCQkJLy8gZXNs\naW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9wcmVm\nZXItbnVsbGlzaC1jb2FsZXNjaW5nCgkJCQlreS5yZXF1ZXN0LmhlYWRlcnMu\nc2V0KCdhY2NlcHQnLCBreS5yZXF1ZXN0LmhlYWRlcnMuZ2V0KCdhY2NlcHQn\nKSB8fCBtaW1lVHlwZSk7CgoJCQkJY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBy\nZXN1bHQ7CgoJCQkJaWYgKHR5cGUgPT09ICdqc29uJykgewoJCQkJCS8vIEt5\nIGludGVudGlvbmFsbHkgcmV0dXJucyBgdW5kZWZpbmVkYCBmb3IgMjA0L2Vt\ncHR5IGJvZGllcyBvbiB0aGUgc2hvcnRjdXQgZm9yCgkJCQkJLy8gZXJnb25v\nbWljICJubyBjb250ZW50IiBoYW5kbGluZy4KCQkJCQlpZiAocmVzcG9uc2Uu\nc3RhdHVzID09PSAyMDQpIHsKCQkJCQkJcmV0dXJuIHVuZGVmaW5lZDsKCQkJ\nCQl9CgoJCQkJCWNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7\nCgkJCQkJaWYgKHRleHQgPT09ICcnKSB7CgkJCQkJCXJldHVybiB1bmRlZmlu\nZWQ7CgkJCQkJfQoKCQkJCQlpZiAob3B0aW9ucy5wYXJzZUpzb24pIHsKCQkJ\nCQkJcmV0dXJuIG9wdGlvbnMucGFyc2VKc29uKHRleHQpOwoJCQkJCX0KCgkJ\nCQkJcmV0dXJuIEpTT04ucGFyc2UodGV4dCk7CgkJCQl9CgoJCQkJcmV0dXJu\nIHJlc3BvbnNlW3R5cGVdKCk7CgkJCX07CgkJfQoKCQlyZXR1cm4gcmVzdWx0\nOwoJfQoKCS8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSB1bmljb3JuL3By\nZXZlbnQtYWJicmV2aWF0aW9ucwoJc3RhdGljICNub3JtYWxpemVTZWFyY2hQ\nYXJhbXMoc2VhcmNoUGFyYW1zOiBTZWFyY2hQYXJhbXNPcHRpb24pOiBTZWFy\nY2hQYXJhbXNPcHRpb24gewoJCS8vIEZpbHRlciBvdXQgdW5kZWZpbmVkIHZh\nbHVlcyBmcm9tIHBsYWluIG9iamVjdHMKCQlpZiAoc2VhcmNoUGFyYW1zICYm\nIHR5cGVvZiBzZWFyY2hQYXJhbXMgPT09ICdvYmplY3QnICYmICFBcnJheS5p\nc0FycmF5KHNlYXJjaFBhcmFtcykgJiYgIShzZWFyY2hQYXJhbXMgaW5zdGFu\nY2VvZiBVUkxTZWFyY2hQYXJhbXMpKSB7CgkJCXJldHVybiBPYmplY3QuZnJv\nbUVudHJpZXMoT2JqZWN0LmVudHJpZXMoc2VhcmNoUGFyYW1zKS5maWx0ZXIo\nKFssIHZhbHVlXSkgPT4gdmFsdWUgIT09IHVuZGVmaW5lZCkpOwoJCX0KCgkJ\ncmV0dXJuIHNlYXJjaFBhcmFtczsKCX0KCglwdWJsaWMgcmVxdWVzdDogUmVx\ndWVzdDsKCSNhYm9ydENvbnRyb2xsZXI/OiBBYm9ydENvbnRyb2xsZXI7Cgkj\ncmV0cnlDb3VudCA9IDA7CgkvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUg\nQHR5cGVzY3JpcHQtZXNsaW50L3ByZWZlci1yZWFkb25seSAtLSBGYWxzZSBw\nb3NpdGl2ZTogI2lucHV0IGlzIHJlYXNzaWduZWQgb24gbGluZSAyMDIKCSNp\nbnB1dDogSW5wdXQ7CglyZWFkb25seSAjb3B0aW9uczogSW50ZXJuYWxPcHRp\nb25zOwoJI29yaWdpbmFsUmVxdWVzdD86IFJlcXVlc3Q7CglyZWFkb25seSAj\ndXNlclByb3ZpZGVkQWJvcnRTaWduYWw/OiBBYm9ydFNpZ25hbDsKCXJlYWRv\nbmx5ICNiZWZvcmVSZXRyeUhvb2tFcnJvcnMgPSBuZXcgV2Vha1NldDxFcnJv\ncj4oKTsKCSNjYWNoZWROb3JtYWxpemVkT3B0aW9uczogTm9ybWFsaXplZE9w\ndGlvbnMgfCB1bmRlZmluZWQ7Cgkjc3RhcnRUaW1lPzogbnVtYmVyOwoKCS8v\nIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb21wbGV4aXR5Cgljb25zdHJ1\nY3RvcihpbnB1dDogSW5wdXQsIG9wdGlvbnM6IE9wdGlvbnMgPSB7fSkgewoJ\nCXRoaXMuI2lucHV0ID0gaW5wdXQ7CgoJCXRoaXMuI29wdGlvbnMgPSB7CgkJ\nCS4uLm9wdGlvbnMsCgkJCWhlYWRlcnM6IG1lcmdlSGVhZGVycygodGhpcy4j\naW5wdXQgYXMgUmVxdWVzdCkuaGVhZGVycywgb3B0aW9ucy5oZWFkZXJzKSwK\nCQkJaG9va3M6IG1lcmdlSG9va3MoCgkJCQl7CgkJCQkJYmVmb3JlUmVxdWVz\ndDogW10sCgkJCQkJYmVmb3JlUmV0cnk6IFtdLAoJCQkJCWJlZm9yZUVycm9y\nOiBbXSwKCQkJCQlhZnRlclJlc3BvbnNlOiBbXSwKCQkJCX0sCgkJCQlvcHRp\nb25zLmhvb2tzLAoJCQkpLAoJCQltZXRob2Q6IG5vcm1hbGl6ZVJlcXVlc3RN\nZXRob2Qob3B0aW9ucy5tZXRob2QgPz8gKHRoaXMuI2lucHV0IGFzIFJlcXVl\nc3QpLm1ldGhvZCA/PyAnR0VUJyksCgkJCS8vIGVzbGludC1kaXNhYmxlLW5l\neHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvcHJlZmVyLW51bGxpc2gtY29h\nbGVzY2luZwoJCQlwcmVmaXhVcmw6IFN0cmluZyhvcHRpb25zLnByZWZpeFVy\nbCB8fCAnJyksCgkJCXJldHJ5OiBub3JtYWxpemVSZXRyeU9wdGlvbnMob3B0\naW9ucy5yZXRyeSksCgkJCXRocm93SHR0cEVycm9yczogb3B0aW9ucy50aHJv\nd0h0dHBFcnJvcnMgPz8gdHJ1ZSwKCQkJdGltZW91dDogb3B0aW9ucy50aW1l\nb3V0ID8/IDEwXzAwMCwKCQkJZmV0Y2g6IG9wdGlvbnMuZmV0Y2ggPz8gZ2xv\nYmFsVGhpcy5mZXRjaC5iaW5kKGdsb2JhbFRoaXMpLAoJCQljb250ZXh0OiBv\ncHRpb25zLmNvbnRleHQgPz8ge30sCgkJfTsKCgkJaWYgKHR5cGVvZiB0aGlz\nLiNpbnB1dCAhPT0gJ3N0cmluZycgJiYgISh0aGlzLiNpbnB1dCBpbnN0YW5j\nZW9mIFVSTCB8fCB0aGlzLiNpbnB1dCBpbnN0YW5jZW9mIGdsb2JhbFRoaXMu\nUmVxdWVzdCkpIHsKCQkJdGhyb3cgbmV3IFR5cGVFcnJvcignYGlucHV0YCBt\ndXN0IGJlIGEgc3RyaW5nLCBVUkwsIG9yIFJlcXVlc3QnKTsKCQl9CgoJCWlm\nICh0aGlzLiNvcHRpb25zLnByZWZpeFVybCAmJiB0eXBlb2YgdGhpcy4jaW5w\ndXQgPT09ICdzdHJpbmcnKSB7CgkJCWlmICh0aGlzLiNpbnB1dC5zdGFydHNX\naXRoKCcvJykpIHsKCQkJCXRocm93IG5ldyBFcnJvcignYGlucHV0YCBtdXN0\nIG5vdCBiZWdpbiB3aXRoIGEgc2xhc2ggd2hlbiB1c2luZyBgcHJlZml4VXJs\nYCcpOwoJCQl9CgoJCQlpZiAoIXRoaXMuI29wdGlvbnMucHJlZml4VXJsLmVu\nZHNXaXRoKCcvJykpIHsKCQkJCXRoaXMuI29wdGlvbnMucHJlZml4VXJsICs9\nICcvJzsKCQkJfQoKCQkJdGhpcy4jaW5wdXQgPSB0aGlzLiNvcHRpb25zLnBy\nZWZpeFVybCArIHRoaXMuI2lucHV0OwoJCX0KCgkJaWYgKHN1cHBvcnRzQWJv\ncnRDb250cm9sbGVyICYmIHN1cHBvcnRzQWJvcnRTaWduYWwpIHsKCQkJdGhp\ncy4jdXNlclByb3ZpZGVkQWJvcnRTaWduYWwgPSB0aGlzLiNvcHRpb25zLnNp\nZ25hbCA/PyAodGhpcy4jaW5wdXQgYXMgUmVxdWVzdCkuc2lnbmFsOwoJCQl0\naGlzLiNhYm9ydENvbnRyb2xsZXIgPSBuZXcgZ2xvYmFsVGhpcy5BYm9ydENv\nbnRyb2xsZXIoKTsKCQkJdGhpcy4jb3B0aW9ucy5zaWduYWwgPSB0aGlzLiN1\nc2VyUHJvdmlkZWRBYm9ydFNpZ25hbCA/IEFib3J0U2lnbmFsLmFueShbdGhp\ncy4jdXNlclByb3ZpZGVkQWJvcnRTaWduYWwsIHRoaXMuI2Fib3J0Q29udHJv\nbGxlci5zaWduYWxdKSA6IHRoaXMuI2Fib3J0Q29udHJvbGxlci5zaWduYWw7\nCgkJfQoKCQlpZiAoc3VwcG9ydHNSZXF1ZXN0U3RyZWFtcykgewoJCQkvLyBA\ndHMtZXhwZWN0LWVycm9yIC0gVHlwZXMgYXJlIG91dGRhdGVkLgoJCQl0aGlz\nLiNvcHRpb25zLmR1cGxleCA9ICdoYWxmJzsKCQl9CgoJCWlmICh0aGlzLiNv\ncHRpb25zLmpzb24gIT09IHVuZGVmaW5lZCkgewoJCQl0aGlzLiNvcHRpb25z\nLmJvZHkgPSB0aGlzLiNvcHRpb25zLnN0cmluZ2lmeUpzb24/Lih0aGlzLiNv\ncHRpb25zLmpzb24pID8/IEpTT04uc3RyaW5naWZ5KHRoaXMuI29wdGlvbnMu\nanNvbik7CgkJCXRoaXMuI29wdGlvbnMuaGVhZGVycy5zZXQoJ2NvbnRlbnQt\ndHlwZScsIHRoaXMuI29wdGlvbnMuaGVhZGVycy5nZXQoJ2NvbnRlbnQtdHlw\nZScpID8/ICdhcHBsaWNhdGlvbi9qc29uJyk7CgkJfQoKCQkvLyBUbyBwcm92\naWRlIGNvcnJlY3QgZm9ybSBib3VuZGFyeSwgQ29udGVudC1UeXBlIGhlYWRl\nciBzaG91bGQgYmUgZGVsZXRlZCB3aGVuIGNyZWF0aW5nIFJlcXVlc3QgZnJv\nbSBhbm90aGVyIFJlcXVlc3Qgd2l0aCBGb3JtRGF0YS9VUkxTZWFyY2hQYXJh\nbXMgYm9keQoJCS8vIE9ubHkgZGVsZXRlIGlmIHVzZXIgZGlkbid0IGV4cGxp\nY2l0bHkgcHJvdmlkZSBhIGN1c3RvbSBjb250ZW50LXR5cGUKCQljb25zdCB1\nc2VyUHJvdmlkZWRDb250ZW50VHlwZSA9IG9wdGlvbnMuaGVhZGVycyAmJiBu\nZXcgZ2xvYmFsVGhpcy5IZWFkZXJzKG9wdGlvbnMuaGVhZGVycyBhcyBIZWFk\nZXJzSW5pdCkuaGFzKCdjb250ZW50LXR5cGUnKTsKCQlpZiAoCgkJCXRoaXMu\nI2lucHV0IGluc3RhbmNlb2YgZ2xvYmFsVGhpcy5SZXF1ZXN0CgkJCSYmICgo\nc3VwcG9ydHNGb3JtRGF0YSAmJiB0aGlzLiNvcHRpb25zLmJvZHkgaW5zdGFu\nY2VvZiBnbG9iYWxUaGlzLkZvcm1EYXRhKSB8fCB0aGlzLiNvcHRpb25zLmJv\nZHkgaW5zdGFuY2VvZiBVUkxTZWFyY2hQYXJhbXMpCgkJCSYmICF1c2VyUHJv\ndmlkZWRDb250ZW50VHlwZQoJCSkgewoJCQl0aGlzLiNvcHRpb25zLmhlYWRl\ncnMuZGVsZXRlKCdjb250ZW50LXR5cGUnKTsKCQl9CgoJCXRoaXMucmVxdWVz\ndCA9IG5ldyBnbG9iYWxUaGlzLlJlcXVlc3QodGhpcy4jaW5wdXQsIHRoaXMu\nI29wdGlvbnMpOwoKCQlpZiAoaGFzU2VhcmNoUGFyYW1ldGVycyh0aGlzLiNv\ncHRpb25zLnNlYXJjaFBhcmFtcykpIHsKCQkJLy8gZXNsaW50LWRpc2FibGUt\nbmV4dC1saW5lIHVuaWNvcm4vcHJldmVudC1hYmJyZXZpYXRpb25zCgkJCWNv\nbnN0IHRleHRTZWFyY2hQYXJhbXMgPSB0eXBlb2YgdGhpcy4jb3B0aW9ucy5z\nZWFyY2hQYXJhbXMgPT09ICdzdHJpbmcnCgkJCQk/IHRoaXMuI29wdGlvbnMu\nc2VhcmNoUGFyYW1zLnJlcGxhY2UoL15cPy8sICcnKQoJCQkJOiBuZXcgVVJM\nU2VhcmNoUGFyYW1zKEt5LiNub3JtYWxpemVTZWFyY2hQYXJhbXModGhpcy4j\nb3B0aW9ucy5zZWFyY2hQYXJhbXMpIGFzIHVua25vd24gYXMgU2VhcmNoUGFy\nYW1zSW5pdCkudG9TdHJpbmcoKTsKCQkJLy8gZXNsaW50LWRpc2FibGUtbmV4\ndC1saW5lIHVuaWNvcm4vcHJldmVudC1hYmJyZXZpYXRpb25zCgkJCWNvbnN0\nIHNlYXJjaFBhcmFtcyA9ICc/JyArIHRleHRTZWFyY2hQYXJhbXM7CgkJCWNv\nbnN0IHVybCA9IHRoaXMucmVxdWVzdC51cmwucmVwbGFjZSgvKD86XD8uKj8p\nPyg/PSN8JCkvLCBzZWFyY2hQYXJhbXMpOwoKCQkJLy8gUmVjcmVhdGUgcmVx\ndWVzdCB3aXRoIHRoZSB1cGRhdGVkIFVSTC4gV2UgYWxyZWFkeSBoYXZlIGFs\nbCBvcHRpb25zIGluIHRoaXMuI29wdGlvbnMsIGluY2x1ZGluZyBkdXBsZXgu\nCgkJCXRoaXMucmVxdWVzdCA9IG5ldyBnbG9iYWxUaGlzLlJlcXVlc3QodXJs\nLCB0aGlzLiNvcHRpb25zIGFzIFJlcXVlc3RJbml0KTsKCQl9CgoJCS8vIElm\nIGBvblVwbG9hZFByb2dyZXNzYCBpcyBwYXNzZWQsIGl0IHVzZXMgdGhlIHN0\ncmVhbSBBUEkgaW50ZXJuYWxseQoJCWlmICh0aGlzLiNvcHRpb25zLm9uVXBs\nb2FkUHJvZ3Jlc3MpIHsKCQkJaWYgKHR5cGVvZiB0aGlzLiNvcHRpb25zLm9u\nVXBsb2FkUHJvZ3Jlc3MgIT09ICdmdW5jdGlvbicpIHsKCQkJCXRocm93IG5l\ndyBUeXBlRXJyb3IoJ1RoZSBgb25VcGxvYWRQcm9ncmVzc2Agb3B0aW9uIG11\nc3QgYmUgYSBmdW5jdGlvbicpOwoJCQl9CgoJCQlpZiAoIXN1cHBvcnRzUmVx\ndWVzdFN0cmVhbXMpIHsKCQkJCXRocm93IG5ldyBFcnJvcignUmVxdWVzdCBz\ndHJlYW1zIGFyZSBub3Qgc3VwcG9ydGVkIGluIHlvdXIgZW52aXJvbm1lbnQu\nIFRoZSBgZHVwbGV4YCBvcHRpb24gZm9yIGBSZXF1ZXN0YCBpcyBub3QgYXZh\naWxhYmxlLicpOwoJCQl9CgkJfQoJfQoKCSNjYWxjdWxhdGVEZWxheSgpOiBu\ndW1iZXIgewoJCWNvbnN0IHJldHJ5RGVsYXkgPSB0aGlzLiNvcHRpb25zLnJl\ndHJ5LmRlbGF5KHRoaXMuI3JldHJ5Q291bnQpOwoKCQlsZXQgaml0dGVyZWRE\nZWxheSA9IHJldHJ5RGVsYXk7CgkJaWYgKHRoaXMuI29wdGlvbnMucmV0cnku\naml0dGVyID09PSB0cnVlKSB7CgkJCWppdHRlcmVkRGVsYXkgPSBNYXRoLnJh\nbmRvbSgpICogcmV0cnlEZWxheTsKCQl9IGVsc2UgaWYgKHR5cGVvZiB0aGlz\nLiNvcHRpb25zLnJldHJ5LmppdHRlciA9PT0gJ2Z1bmN0aW9uJykgewoJCQlq\naXR0ZXJlZERlbGF5ID0gdGhpcy4jb3B0aW9ucy5yZXRyeS5qaXR0ZXIocmV0\ncnlEZWxheSk7CgoJCQlpZiAoIU51bWJlci5pc0Zpbml0ZShqaXR0ZXJlZERl\nbGF5KSB8fCBqaXR0ZXJlZERlbGF5IDwgMCkgewoJCQkJaml0dGVyZWREZWxh\neSA9IHJldHJ5RGVsYXk7CgkJCX0KCQl9CgoJCS8vIEhhbmRsZSB1bmRlZmlu\nZWQgYmFja29mZkxpbWl0IGJ5IHRyZWF0aW5nIGl0IGFzIG5vIGxpbWl0IChJ\nbmZpbml0eSkKCQljb25zdCBiYWNrb2ZmTGltaXQgPSB0aGlzLiNvcHRpb25z\nLnJldHJ5LmJhY2tvZmZMaW1pdCA/PyBOdW1iZXIuUE9TSVRJVkVfSU5GSU5J\nVFk7CgkJcmV0dXJuIE1hdGgubWluKGJhY2tvZmZMaW1pdCwgaml0dGVyZWRE\nZWxheSk7Cgl9CgoJI2NsYW1wUmV0cnlEZWxheVRvTWF4KHJldHJ5RGVsYXk6\nIG51bWJlcik6IG51bWJlciB7CgkJY29uc3Qge21heFJldHJ5QWZ0ZXJ9ID0g\ndGhpcy4jb3B0aW9ucy5yZXRyeTsKCQlyZXR1cm4gbWF4UmV0cnlBZnRlciA9\nPT0gdW5kZWZpbmVkID8gcmV0cnlEZWxheSA6IE1hdGgubWluKG1heFJldHJ5\nQWZ0ZXIsIHJldHJ5RGVsYXkpOwoJfQoKCWFzeW5jICNjYWxjdWxhdGVSZXRy\neURlbGF5KGVycm9yOiB1bmtub3duKSB7CgkJdGhpcy4jcmV0cnlDb3VudCsr\nOwoKCQlpZiAodGhpcy4jcmV0cnlDb3VudCA+IHRoaXMuI29wdGlvbnMucmV0\ncnkubGltaXQpIHsKCQkJdGhyb3cgZXJyb3I7CgkJfQoKCQkvLyBXcmFwIG5v\nbi1FcnJvciB0aHJvd3MgdG8gZW5zdXJlIGNvbnNpc3RlbnQgZXJyb3IgaGFu\nZGxpbmcKCQljb25zdCBlcnJvck9iamVjdCA9IGVycm9yIGluc3RhbmNlb2Yg\nRXJyb3IgPyBlcnJvciA6IG5ldyBOb25FcnJvcihlcnJvcik7CgoJCS8vIEhh\nbmRsZSBmb3JjZWQgcmV0cnkgZnJvbSBhZnRlclJlc3BvbnNlIGhvb2sgLSBz\na2lwIG1ldGhvZCBjaGVjayBhbmQgc2hvdWxkUmV0cnkKCQlpZiAoZXJyb3JP\nYmplY3QgaW5zdGFuY2VvZiBGb3JjZVJldHJ5RXJyb3IpIHsKCQkJcmV0dXJu\nIGVycm9yT2JqZWN0LmN1c3RvbURlbGF5ID8/IHRoaXMuI2NhbGN1bGF0ZURl\nbGF5KCk7CgkJfQoKCQkvLyBDaGVjayBpZiBtZXRob2QgaXMgcmV0cmlhYmxl\nIGZvciBub24tZm9yY2VkIHJldHJpZXMKCQlpZiAoIXRoaXMuI29wdGlvbnMu\ncmV0cnkubWV0aG9kcy5pbmNsdWRlcyh0aGlzLnJlcXVlc3QubWV0aG9kLnRv\nTG93ZXJDYXNlKCkpKSB7CgkJCXRocm93IGVycm9yOwoJCX0KCgkJLy8gVXNl\nci1wcm92aWRlZCBzaG91bGRSZXRyeSBmdW5jdGlvbiB0YWtlcyBwcmVjZWRl\nbmNlIG92ZXIgYWxsIG90aGVyIGNoZWNrcwoJCWlmICh0aGlzLiNvcHRpb25z\nLnJldHJ5LnNob3VsZFJldHJ5ICE9PSB1bmRlZmluZWQpIHsKCQkJY29uc3Qg\ncmVzdWx0ID0gYXdhaXQgdGhpcy4jb3B0aW9ucy5yZXRyeS5zaG91bGRSZXRy\neSh7ZXJyb3I6IGVycm9yT2JqZWN0LCByZXRyeUNvdW50OiB0aGlzLiNyZXRy\neUNvdW50fSk7CgoJCQkvLyBTdHJpY3QgYm9vbGVhbiBjaGVja2luZyAtIG9u\nbHkgZXhhY3QgdHJ1ZS9mYWxzZSBhcmUgaGFuZGxlZCBzcGVjaWFsbHkKCQkJ\naWYgKHJlc3VsdCA9PT0gZmFsc2UpIHsKCQkJCXRocm93IGVycm9yOwoJCQl9\nCgoJCQlpZiAocmVzdWx0ID09PSB0cnVlKSB7CgkJCQkvLyBGb3JjZSByZXRy\neSAtIHNraXAgYWxsIG90aGVyIHZhbGlkYXRpb24gYW5kIHJldHVybiBkZWxh\neQoJCQkJcmV0dXJuIHRoaXMuI2NhbGN1bGF0ZURlbGF5KCk7CgkJCX0KCgkJ\nCS8vIElmIHVuZGVmaW5lZCBvciBhbnkgb3RoZXIgdmFsdWUsIGZhbGwgdGhy\nb3VnaCB0byBkZWZhdWx0IGJlaGF2aW9yCgkJfQoKCQkvLyBEZWZhdWx0IHRp\nbWVvdXQgYmVoYXZpb3IKCQlpZiAoaXNUaW1lb3V0RXJyb3IoZXJyb3IpICYm\nICF0aGlzLiNvcHRpb25zLnJldHJ5LnJldHJ5T25UaW1lb3V0KSB7CgkJCXRo\ncm93IGVycm9yOwoJCX0KCgkJaWYgKGlzSFRUUEVycm9yKGVycm9yKSkgewoJ\nCQlpZiAoIXRoaXMuI29wdGlvbnMucmV0cnkuc3RhdHVzQ29kZXMuaW5jbHVk\nZXMoZXJyb3IucmVzcG9uc2Uuc3RhdHVzKSkgewoJCQkJdGhyb3cgZXJyb3I7\nCgkJCX0KCgkJCWNvbnN0IHJldHJ5QWZ0ZXIgPSBlcnJvci5yZXNwb25zZS5o\nZWFkZXJzLmdldCgnUmV0cnktQWZ0ZXInKQoJCQkJPz8gZXJyb3IucmVzcG9u\nc2UuaGVhZGVycy5nZXQoJ1JhdGVMaW1pdC1SZXNldCcpCgkJCQk/PyBlcnJv\nci5yZXNwb25zZS5oZWFkZXJzLmdldCgnWC1SYXRlTGltaXQtUmV0cnktQWZ0\nZXInKSAvLyBTeW1mb255LWJhc2VkIHNlcnZpY2VzCgkJCQk/PyBlcnJvci5y\nZXNwb25zZS5oZWFkZXJzLmdldCgnWC1SYXRlTGltaXQtUmVzZXQnKSAvLyBH\naXRIdWIKCQkJCT8/IGVycm9yLnJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdYLVJh\ndGUtTGltaXQtUmVzZXQnKTsgLy8gVHdpdHRlcgoJCQlpZiAocmV0cnlBZnRl\nciAmJiB0aGlzLiNvcHRpb25zLnJldHJ5LmFmdGVyU3RhdHVzQ29kZXMuaW5j\nbHVkZXMoZXJyb3IucmVzcG9uc2Uuc3RhdHVzKSkgewoJCQkJbGV0IGFmdGVy\nID0gTnVtYmVyKHJldHJ5QWZ0ZXIpICogMTAwMDsKCQkJCWlmIChOdW1iZXIu\naXNOYU4oYWZ0ZXIpKSB7CgkJCQkJYWZ0ZXIgPSBEYXRlLnBhcnNlKHJldHJ5\nQWZ0ZXIpIC0gRGF0ZS5ub3coKTsKCQkJCX0gZWxzZSBpZiAoYWZ0ZXIgPj0g\nRGF0ZS5wYXJzZSgnMjAyNC0wMS0wMScpKSB7CgkJCQkJLy8gQSBsYXJnZSBu\ndW1iZXIgaXMgdHJlYXRlZCBhcyBhIHRpbWVzdGFtcCAoZml4ZWQgdGhyZXNo\nb2xkIHByb3RlY3RzIGFnYWluc3QgY2xvY2sgc2tldykKCQkJCQlhZnRlciAt\nPSBEYXRlLm5vdygpOwoJCQkJfQoKCQkJCWlmICghTnVtYmVyLmlzRmluaXRl\nKGFmdGVyKSkgewoJCQkJCXJldHVybiB0aGlzLiNjbGFtcFJldHJ5RGVsYXlU\nb01heCh0aGlzLiNjYWxjdWxhdGVEZWxheSgpKTsKCQkJCX0KCgkJCQlhZnRl\nciA9IE1hdGgubWF4KDAsIGFmdGVyKTsKCgkJCQkvLyBEb24ndCBhcHBseSBq\naXR0ZXIgd2hlbiBzZXJ2ZXIgcHJvdmlkZXMgZXhwbGljaXQgcmV0cnkgdGlt\naW5nCgkJCQlyZXR1cm4gdGhpcy4jY2xhbXBSZXRyeURlbGF5VG9NYXgoYWZ0\nZXIpOwoJCQl9CgoJCQlpZiAoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0\nMTMpIHsKCQkJCXRocm93IGVycm9yOwoJCQl9CgkJfQoKCQlyZXR1cm4gdGhp\ncy4jY2FsY3VsYXRlRGVsYXkoKTsKCX0KCgkjZGVjb3JhdGVSZXNwb25zZShy\nZXNwb25zZTogUmVzcG9uc2UpOiBSZXNwb25zZSB7CgkJaWYgKHRoaXMuI29w\ndGlvbnMucGFyc2VKc29uKSB7CgkJCXJlc3BvbnNlLmpzb24gPSBhc3luYyAo\nKSA9PiB0aGlzLiNvcHRpb25zLnBhcnNlSnNvbiEoYXdhaXQgcmVzcG9uc2Uu\ndGV4dCgpKTsKCQl9CgoJCXJldHVybiByZXNwb25zZTsKCX0KCglhc3luYyAj\nZ2V0UmVzcG9uc2VEYXRhKHJlc3BvbnNlOiBSZXNwb25zZSk6IFByb21pc2U8\ndW5rbm93bj4gewoJCS8vIEV2ZW4gd2l0aCByZXF1ZXN0IHRpbWVvdXRzIGRp\nc2FibGVkLCBib3VuZCBlcnJvci1ib2R5IHJlYWRzIHNvIHJldHJpZXMgYW5k\nIGVycm9yIHByb3BhZ2F0aW9uCgkJLy8gY2Fubm90IGJlIHN0YWxsZWQgaW5k\nZWZpbml0ZWx5IGJ5IG5ldmVyLWVuZGluZyByZXNwb25zZSBzdHJlYW1zLgoJ\nCWNvbnN0IGVycm9yRGF0YVRpbWVvdXQgPSB0aGlzLiNvcHRpb25zLnRpbWVv\ndXQgPT09IGZhbHNlID8gMTBfMDAwIDogdGhpcy4jb3B0aW9ucy50aW1lb3V0\nOwoJCWNvbnN0IHRleHQgPSBhd2FpdCB0aGlzLiNyZWFkUmVzcG9uc2VUZXh0\nKHJlc3BvbnNlLCBlcnJvckRhdGFUaW1lb3V0KTsKCgkJaWYgKCF0ZXh0KSB7\nCgkJCXJldHVybiB1bmRlZmluZWQ7CgkJfQoKCQlpZiAoIXRoaXMuI2lzSnNv\nbkNvbnRlbnRUeXBlKHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdjb250ZW50LXR5\ncGUnKSA/PyAnJykpIHsKCQkJcmV0dXJuIHRleHQ7CgkJfQoKCQlyZXR1cm4g\ndGhpcy4jcGFyc2VKc29uKHRleHQsIGVycm9yRGF0YVRpbWVvdXQpOwoJfQoK\nCSNpc0pzb25Db250ZW50VHlwZShjb250ZW50VHlwZTogc3RyaW5nKTogYm9v\nbGVhbiB7CgkJLy8gTWF0Y2ggSlNPTiBzdWJ0eXBlcyBsaWtlIGBqc29uYCwg\nYHByb2JsZW0ranNvbmAsIGFuZCBgdm5kLmFwaStqc29uYC4KCQljb25zdCBt\naW1lVHlwZSA9IChjb250ZW50VHlwZS5zcGxpdCgnOycsIDEpWzBdID8/ICcn\nKS50cmltKCkudG9Mb3dlckNhc2UoKTsKCQlyZXR1cm4gL1wvKD86LipbList\nXSk/anNvbiQvLnRlc3QobWltZVR5cGUpOwoJfQoKCWFzeW5jICNyZWFkUmVz\ncG9uc2VUZXh0KHJlc3BvbnNlOiBSZXNwb25zZSwgdGltZW91dE1zOiBudW1i\nZXIpOiBQcm9taXNlPHN0cmluZyB8IHVuZGVmaW5lZD4gewoJCWNvbnN0IHti\nb2R5fSA9IHJlc3BvbnNlOwoJCWlmICghYm9keSkgewoJCQl0cnkgewoJCQkJ\ncmV0dXJuIGF3YWl0IHJlc3BvbnNlLnRleHQoKTsKCQkJfSBjYXRjaCB7CgkJ\nCQlyZXR1cm4gdW5kZWZpbmVkOwoJCQl9CgkJfQoKCQlsZXQgcmVhZGVyOiBS\nZWFkYWJsZVN0cmVhbURlZmF1bHRSZWFkZXI8VWludDhBcnJheT47CgkJdHJ5\nIHsKCQkJcmVhZGVyID0gYm9keS5nZXRSZWFkZXIoKTsKCQl9IGNhdGNoIHsK\nCQkJLy8gQW5vdGhlciBjb25zdW1lciBhbHJlYWR5IGxvY2tlZCB0aGUgc3Ry\nZWFtLgoJCQlyZXR1cm4gdW5kZWZpbmVkOwoJCX0KCgkJY29uc3QgZGVjb2Rl\nciA9IGNyZWF0ZVRleHREZWNvZGVyKHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdj\nb250ZW50LXR5cGUnKSA/PyAnJyk7CgkJY29uc3QgY2h1bmtzOiBzdHJpbmdb\nXSA9IFtdOwoJCWxldCB0b3RhbEJ5dGVzID0gMDsKCgkJY29uc3QgcmVhZEFs\nbCA9IChhc3luYyAoKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+ID0+\nIHsKCQkJdHJ5IHsKCQkJCWZvciAoOzspIHsKCQkJCQkvLyBlc2xpbnQtZGlz\nYWJsZS1uZXh0LWxpbmUgbm8tYXdhaXQtaW4tbG9vcAoJCQkJCWNvbnN0IHtk\nb25lLCB2YWx1ZX0gPSBhd2FpdCByZWFkZXIucmVhZCgpOwoJCQkJCWlmIChk\nb25lKSB7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCgkJCQkJdG90YWxCeXRlcyAr\nPSB2YWx1ZS5ieXRlTGVuZ3RoOwoJCQkJCWlmICh0b3RhbEJ5dGVzID4gbWF4\nRXJyb3JSZXNwb25zZUJvZHlTaXplKSB7CgkJCQkJCXZvaWQgcmVhZGVyLmNh\nbmNlbCgpLmNhdGNoKCgpID0+IHVuZGVmaW5lZCk7CgkJCQkJCXJldHVybiB1\nbmRlZmluZWQ7CgkJCQkJfQoKCQkJCQljaHVua3MucHVzaChkZWNvZGVyLmRl\nY29kZSh2YWx1ZSwge3N0cmVhbTogdHJ1ZX0pKTsKCQkJCX0KCQkJfSBjYXRj\naCB7CgkJCQlyZXR1cm4gdW5kZWZpbmVkOwoJCQl9CgoJCQljaHVua3MucHVz\naChkZWNvZGVyLmRlY29kZSgpKTsKCQkJcmV0dXJuIGNodW5rcy5qb2luKCcn\nKTsKCQl9KSgpOwoKCQljb25zdCB0aW1lb3V0UHJvbWlzZSA9IG5ldyBQcm9t\naXNlPHVuZGVmaW5lZD4ocmVzb2x2ZSA9PiB7CgkJCWNvbnN0IHRpbWVvdXRJ\nZCA9IHNldFRpbWVvdXQoKCkgPT4gewoJCQkJcmVzb2x2ZSh1bmRlZmluZWQp\nOwoJCQl9LCB0aW1lb3V0TXMpOwoJCQl2b2lkIHJlYWRBbGwuZmluYWxseSgo\nKSA9PiB7CgkJCQljbGVhclRpbWVvdXQodGltZW91dElkKTsKCQkJfSk7CgkJ\nfSk7CgoJCWNvbnN0IHJlc3VsdCA9IGF3YWl0IFByb21pc2UucmFjZShbcmVh\nZEFsbCwgdGltZW91dFByb21pc2VdKTsKCQlpZiAocmVzdWx0ID09PSB1bmRl\nZmluZWQpIHsKCQkJdm9pZCByZWFkZXIuY2FuY2VsKCkuY2F0Y2goKCkgPT4g\ndW5kZWZpbmVkKTsKCQl9CgoJCXJldHVybiByZXN1bHQ7Cgl9CgoJYXN5bmMg\nI3BhcnNlSnNvbih0ZXh0OiBzdHJpbmcsIHRpbWVvdXRNczogbnVtYmVyKTog\nUHJvbWlzZTx1bmtub3duPiB7CgkJbGV0IHRpbWVvdXRJZDogUmV0dXJuVHlw\nZTx0eXBlb2Ygc2V0VGltZW91dD4gfCB1bmRlZmluZWQ7CgkJdHJ5IHsKCQkJ\ncmV0dXJuIGF3YWl0IFByb21pc2UucmFjZShbCgkJCQlQcm9taXNlLnJlc29s\ndmUoKS50aGVuKCgpID0+ICh0aGlzLiNvcHRpb25zLnBhcnNlSnNvbiA/PyBK\nU09OLnBhcnNlKSh0ZXh0KSksCgkJCQluZXcgUHJvbWlzZTx1bmRlZmluZWQ+\nKHJlc29sdmUgPT4gewoJCQkJCXRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkg\nPT4gewoJCQkJCQlyZXNvbHZlKHVuZGVmaW5lZCk7CgkJCQkJfSwgdGltZW91\ndE1zKTsKCQkJCX0pLAoJCQldKTsKCQl9IGNhdGNoIHsKCQkJcmV0dXJuIHVu\nZGVmaW5lZDsKCQl9IGZpbmFsbHkgewoJCQljbGVhclRpbWVvdXQodGltZW91\ndElkKTsKCQl9Cgl9CgoJI2NhbmNlbEJvZHkoYm9keTogUmVhZGFibGVTdHJl\nYW0gfCB1bmRlZmluZWQpOiB2b2lkIHsKCQlpZiAoIWJvZHkpIHsKCQkJcmV0\ndXJuOwoJCX0KCgkJLy8gSWdub3JlIGNhbmNlbGxhdGlvbiBmYWlsdXJlcyBm\ncm9tIGFscmVhZHktbG9ja2VkIG9yIGFscmVhZHktY29uc3VtZWQgc3RyZWFt\ncy4KCQl2b2lkIGJvZHkuY2FuY2VsKCkuY2F0Y2goKCkgPT4gdW5kZWZpbmVk\nKTsKCX0KCgkjY2FuY2VsUmVzcG9uc2VCb2R5KHJlc3BvbnNlOiBSZXNwb25z\nZSk6IHZvaWQgewoJCS8vIElnbm9yZSBjYW5jZWxsYXRpb24gZmFpbHVyZXMg\nZnJvbSBhbHJlYWR5LWxvY2tlZCBvciBhbHJlYWR5LWNvbnN1bWVkIHN0cmVh\nbXMuCgkJdGhpcy4jY2FuY2VsQm9keShyZXNwb25zZS5ib2R5ID8/IHVuZGVm\naW5lZCk7Cgl9CgoJYXN5bmMgI3JldHJ5PFQgZXh0ZW5kcyAoLi4uYXJndW1l\nbnRzXzogYW55KSA9PiBQcm9taXNlPGFueT4+KGZ1bmN0aW9uXzogVCk6IFBy\nb21pc2U8UmV0dXJuVHlwZTxUPiB8IFJlc3BvbnNlIHwgdm9pZD4gewoJCXRy\neSB7CgkJCXJldHVybiBhd2FpdCBmdW5jdGlvbl8oKTsKCQl9IGNhdGNoIChl\ncnJvcikgewoJCQljb25zdCByZXRyeURlbGF5ID0gTWF0aC5taW4oYXdhaXQg\ndGhpcy4jY2FsY3VsYXRlUmV0cnlEZWxheShlcnJvciksIG1heFNhZmVUaW1l\nb3V0KTsKCQkJY29uc3QgZGVsYXlPcHRpb25zID0gdGhpcy4jdXNlclByb3Zp\nZGVkQWJvcnRTaWduYWwgPyB7c2lnbmFsOiB0aGlzLiN1c2VyUHJvdmlkZWRB\nYm9ydFNpZ25hbH0gOiB7fTsKCgkJCWxldCBkZWxheU1zID0gcmV0cnlEZWxh\neTsKCQkJY29uc3QgcmVtYWluaW5nVGltZW91dCA9IHRoaXMuI2dldFJlbWFp\nbmluZ1RpbWVvdXQoKTsKCQkJaWYgKHJlbWFpbmluZ1RpbWVvdXQgIT09IHVu\nZGVmaW5lZCkgewoJCQkJaWYgKHJlbWFpbmluZ1RpbWVvdXQgPD0gMCkgewoJ\nCQkJCXRocm93IG5ldyBUaW1lb3V0RXJyb3IodGhpcy5yZXF1ZXN0KTsKCQkJ\nCX0KCgkJCQkvLyBJZiB3YWl0aW5nIHdvdWxkIGNvbnN1bWUgYWxsIHJlbWFp\nbmluZyBidWRnZXQsIHRpbWUgb3V0IHdpdGhvdXQgc3RhcnRpbmcgYW5vdGhl\nciByZXF1ZXN0LgoJCQkJaWYgKGRlbGF5TXMgPj0gcmVtYWluaW5nVGltZW91\ndCkgewoJCQkJCWF3YWl0IGRlbGF5KHJlbWFpbmluZ1RpbWVvdXQsIGRlbGF5\nT3B0aW9ucyk7CgkJCQkJdGhyb3cgbmV3IFRpbWVvdXRFcnJvcih0aGlzLnJl\ncXVlc3QpOwoJCQkJfQoKCQkJCWRlbGF5TXMgPSBNYXRoLm1pbihkZWxheU1z\nLCByZW1haW5pbmdUaW1lb3V0KTsKCQkJfQoKCQkJLy8gT25seSB1c2UgdXNl\nci1wcm92aWRlZCBzaWduYWwgZm9yIGRlbGF5LCBub3Qgb3VyIGludGVybmFs\nIGFib3J0Q29udHJvbGxlcgoJCQlhd2FpdCBkZWxheShkZWxheU1zLCBkZWxh\neU9wdGlvbnMpOwoKCQkJY29uc3QgcmVtYWluaW5nVGltZW91dEFmdGVyRGVs\nYXkgPSB0aGlzLiNnZXRSZW1haW5pbmdUaW1lb3V0KCk7CgkJCWlmICgKCQkJ\nCXJlbWFpbmluZ1RpbWVvdXRBZnRlckRlbGF5ICE9PSB1bmRlZmluZWQKCQkJ\nCSYmIHJlbWFpbmluZ1RpbWVvdXRBZnRlckRlbGF5IDw9IDAKCQkJKSB7CgkJ\nCQl0aHJvdyBuZXcgVGltZW91dEVycm9yKHRoaXMucmVxdWVzdCk7CgkJCX0K\nCgkJCS8vIEFwcGx5IGN1c3RvbSByZXF1ZXN0IGZyb20gZm9yY2VkIHJldHJ5\nIGJlZm9yZSBiZWZvcmVSZXRyeSBob29rcwoJCQkvLyBFbnN1cmUgdGhlIGN1\nc3RvbSByZXF1ZXN0IGhhcyB0aGUgY29ycmVjdCBtYW5hZ2VkIHNpZ25hbCBm\nb3IgdGltZW91dHMgYW5kIHVzZXIgYWJvcnRzCgkJCWlmIChlcnJvciBpbnN0\nYW5jZW9mIEZvcmNlUmV0cnlFcnJvciAmJiBlcnJvci5jdXN0b21SZXF1ZXN0\nKSB7CgkJCQljb25zdCBtYW5hZ2VkUmVxdWVzdCA9IHRoaXMuI29wdGlvbnMu\nc2lnbmFsCgkJCQkJPyBuZXcgZ2xvYmFsVGhpcy5SZXF1ZXN0KGVycm9yLmN1\nc3RvbVJlcXVlc3QsIHtzaWduYWw6IHRoaXMuI29wdGlvbnMuc2lnbmFsfSkK\nCQkJCQk6IG5ldyBnbG9iYWxUaGlzLlJlcXVlc3QoZXJyb3IuY3VzdG9tUmVx\ndWVzdCk7CgoJCQkJdGhpcy4jYXNzaWduUmVxdWVzdChtYW5hZ2VkUmVxdWVz\ndCk7CgkJCX0KCgkJCWZvciAoY29uc3QgaG9vayBvZiB0aGlzLiNvcHRpb25z\nLmhvb2tzLmJlZm9yZVJldHJ5KSB7CgkJCQlsZXQgaG9va1Jlc3VsdDogQXdh\naXRlZDxSZXR1cm5UeXBlPHR5cGVvZiBob29rPj47CgkJCQl0cnkgewoJCQkJ\nCS8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1hd2FpdC1pbi1sb29w\nCgkJCQkJaG9va1Jlc3VsdCA9IGF3YWl0IGhvb2soewoJCQkJCQlyZXF1ZXN0\nOiB0aGlzLnJlcXVlc3QsCgkJCQkJCW9wdGlvbnM6IHRoaXMuI2dldE5vcm1h\nbGl6ZWRPcHRpb25zKCksCgkJCQkJCWVycm9yOiBlcnJvciBhcyBFcnJvciwK\nCQkJCQkJcmV0cnlDb3VudDogdGhpcy4jcmV0cnlDb3VudCwKCQkJCQl9KTsK\nCQkJCX0gY2F0Y2ggKGhvb2tFcnJvcikgewoJCQkJCS8vIFByZXNlcnZlIHRo\nZSBvcmlnaW5hbCByZXF1ZXN0IGVycm9yIHBhdGggKGB0aHJvdyBlcnJvcmAp\nIHNvIGJlZm9yZUVycm9yIGhvb2tzIGNhbiBzdGlsbCBydW4uCgkJCQkJaWYg\nKGhvb2tFcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGhvb2tFcnJvciAhPT0g\nZXJyb3IpIHsKCQkJCQkJdGhpcy4jYmVmb3JlUmV0cnlIb29rRXJyb3JzLmFk\nZChob29rRXJyb3IpOwoJCQkJCX0KCgkJCQkJdGhyb3cgaG9va0Vycm9yOwoJ\nCQkJfQoKCQkJCWlmIChob29rUmVzdWx0IGluc3RhbmNlb2YgZ2xvYmFsVGhp\ncy5SZXF1ZXN0KSB7CgkJCQkJdGhpcy4jYXNzaWduUmVxdWVzdChob29rUmVz\ndWx0KTsKCQkJCQlicmVhazsKCQkJCX0KCgkJCQkvLyBJZiBhIFJlc3BvbnNl\nIGlzIHJldHVybmVkLCB1c2UgaXQgYW5kIHNraXAgdGhlIHJldHJ5CgkJCQlp\nZiAoaG9va1Jlc3VsdCBpbnN0YW5jZW9mIGdsb2JhbFRoaXMuUmVzcG9uc2Up\nIHsKCQkJCQlyZXR1cm4gaG9va1Jlc3VsdDsKCQkJCX0KCgkJCQkvLyBJZiBg\nc3RvcGAgaXMgcmV0dXJuZWQgZnJvbSB0aGUgaG9vaywgdGhlIHJldHJ5IHBy\nb2Nlc3MgaXMgc3RvcHBlZAoJCQkJaWYgKGhvb2tSZXN1bHQgPT09IHN0b3Ap\nIHsKCQkJCQlyZXR1cm47CgkJCQl9CgkJCX0KCgkJCWNvbnN0IHJlbWFpbmlu\nZ1RpbWVvdXRBZnRlckJlZm9yZVJldHJ5SG9va3MgPSB0aGlzLiNnZXRSZW1h\naW5pbmdUaW1lb3V0KCk7CgkJCWlmICgKCQkJCXJlbWFpbmluZ1RpbWVvdXRB\nZnRlckJlZm9yZVJldHJ5SG9va3MgIT09IHVuZGVmaW5lZAoJCQkJJiYgcmVt\nYWluaW5nVGltZW91dEFmdGVyQmVmb3JlUmV0cnlIb29rcyA8PSAwCgkJCSkg\newoJCQkJdGhyb3cgbmV3IFRpbWVvdXRFcnJvcih0aGlzLnJlcXVlc3QpOwoJ\nCQl9CgoJCQlyZXR1cm4gdGhpcy4jcmV0cnkoZnVuY3Rpb25fKTsKCQl9Cgl9\nCgoJYXN5bmMgI2ZldGNoKCk6IFByb21pc2U8UmVzcG9uc2U+IHsKCQkvLyBS\nZXNldCBhYm9ydENvbnRyb2xsZXIgaWYgaXQgd2FzIGFib3J0ZWQgKGhhcHBl\nbnMgb24gdGltZW91dCByZXRyeSkKCQlpZiAodGhpcy4jYWJvcnRDb250cm9s\nbGVyPy5zaWduYWwuYWJvcnRlZCkgewoJCQl0aGlzLiNhYm9ydENvbnRyb2xs\nZXIgPSBuZXcgZ2xvYmFsVGhpcy5BYm9ydENvbnRyb2xsZXIoKTsKCQkJdGhp\ncy4jb3B0aW9ucy5zaWduYWwgPSB0aGlzLiN1c2VyUHJvdmlkZWRBYm9ydFNp\nZ25hbCA/IEFib3J0U2lnbmFsLmFueShbdGhpcy4jdXNlclByb3ZpZGVkQWJv\ncnRTaWduYWwsIHRoaXMuI2Fib3J0Q29udHJvbGxlci5zaWduYWxdKSA6IHRo\naXMuI2Fib3J0Q29udHJvbGxlci5zaWduYWw7CgkJCS8vIFJlY3JlYXRlIHJl\ncXVlc3Qgd2l0aCBuZXcgc2lnbmFsCgkJCXRoaXMucmVxdWVzdCA9IG5ldyBn\nbG9iYWxUaGlzLlJlcXVlc3QodGhpcy5yZXF1ZXN0LCB7c2lnbmFsOiB0aGlz\nLiNvcHRpb25zLnNpZ25hbH0pOwoJCX0KCgkJZm9yIChjb25zdCBob29rIG9m\nIHRoaXMuI29wdGlvbnMuaG9va3MuYmVmb3JlUmVxdWVzdCkgewoJCQkvLyBl\nc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYXdhaXQtaW4tbG9vcAoJCQlj\nb25zdCByZXN1bHQgPSBhd2FpdCBob29rKHsKCQkJCXJlcXVlc3Q6IHRoaXMu\ncmVxdWVzdCwKCQkJCW9wdGlvbnM6IHRoaXMuI2dldE5vcm1hbGl6ZWRPcHRp\nb25zKCksCgkJCQlyZXRyeUNvdW50OiB0aGlzLiNyZXRyeUNvdW50LAoJCQl9\nKTsKCgkJCWlmIChyZXN1bHQgaW5zdGFuY2VvZiBSZXNwb25zZSkgewoJCQkJ\ncmV0dXJuIHJlc3VsdDsKCQkJfQoKCQkJaWYgKHJlc3VsdCBpbnN0YW5jZW9m\nIGdsb2JhbFRoaXMuUmVxdWVzdCkgewoJCQkJdGhpcy4jYXNzaWduUmVxdWVz\ndChyZXN1bHQpOwoJCQl9CgkJfQoKCQljb25zdCBub25SZXF1ZXN0T3B0aW9u\ncyA9IGZpbmRVbmtub3duT3B0aW9ucyh0aGlzLnJlcXVlc3QsIHRoaXMuI29w\ndGlvbnMpOwoJCWNvbnN0IHJldHJ5UmVxdWVzdCA9IHRoaXMuI29wdGlvbnMu\ncmV0cnkubGltaXQgPiAwID8gdGhpcy5yZXF1ZXN0LmNsb25lKCkgOiB1bmRl\nZmluZWQ7CgkJY29uc3QgcmVxdWVzdCA9IHRoaXMuI3dyYXBSZXF1ZXN0V2l0\naFVwbG9hZFByb2dyZXNzKHRoaXMucmVxdWVzdCwgdGhpcy4jb3B0aW9ucy5i\nb2R5ID8/IHVuZGVmaW5lZCk7CgoJCS8vIENsb25pbmcgaXMgZG9uZSBoZXJl\nIHRvIHByZXBhcmUgaW4gYWR2YW5jZSBmb3IgcmV0cmllcy4KCQkvLyBTa2lw\nIGNsb25pbmcgd2hlbiByZXRyaWVzIGFyZSBkaXNhYmxlZCDigJQgY2xvbmlu\nZyBhIHN0cmVhbWluZyBib2R5IGNhbGxzIFJlYWRhYmxlU3RyZWFtI3RlZSgp\nCgkJLy8gd2hpY2ggYnVmZmVycyB0aGUgZW50aXJlIHN0cmVhbSBpbiBtZW1v\ncnksIGNhdXNpbmcgZXhjZXNzaXZlIG1lbW9yeSB1c2FnZSBmb3IgbGFyZ2Ug\ndXBsb2Fkcy4KCQl0aGlzLiNvcmlnaW5hbFJlcXVlc3QgPSByZXF1ZXN0OwoJ\nCWlmIChyZXRyeVJlcXVlc3QpIHsKCQkJdGhpcy5yZXF1ZXN0ID0gcmV0cnlS\nZXF1ZXN0OwoJCX0KCgkJaWYgKHRoaXMuI29wdGlvbnMudGltZW91dCA9PT0g\nZmFsc2UpIHsKCQkJcmV0dXJuIHRoaXMuI29wdGlvbnMuZmV0Y2gocmVxdWVz\ndCwgbm9uUmVxdWVzdE9wdGlvbnMpOwoJCX0KCgkJY29uc3QgcmVtYWluaW5n\nVGltZW91dCA9IHRoaXMuI2dldFJlbWFpbmluZ1RpbWVvdXQoKSA/PyB0aGlz\nLiNvcHRpb25zLnRpbWVvdXQ7CgkJaWYgKHJlbWFpbmluZ1RpbWVvdXQgPD0g\nMCkgewoJCQl0aHJvdyBuZXcgVGltZW91dEVycm9yKHRoaXMucmVxdWVzdCk7\nCgkJfQoKCQlyZXR1cm4gdGltZW91dChyZXF1ZXN0LCBub25SZXF1ZXN0T3B0\naW9ucywgdGhpcy4jYWJvcnRDb250cm9sbGVyLCB7CgkJCS4uLnRoaXMuI29w\ndGlvbnMsCgkJCXRpbWVvdXQ6IHJlbWFpbmluZ1RpbWVvdXQsCgkJfSBhcyBU\naW1lb3V0T3B0aW9ucyk7Cgl9CgoJI2dldFJlbWFpbmluZ1RpbWVvdXQoKTog\nbnVtYmVyIHwgdW5kZWZpbmVkIHsKCQlpZiAodGhpcy4jb3B0aW9ucy50aW1l\nb3V0ID09PSBmYWxzZSkgewoJCQlyZXR1cm4gdW5kZWZpbmVkOwoJCX0KCgkJ\naWYgKHRoaXMuI3N0YXJ0VGltZSA9PT0gdW5kZWZpbmVkKSB7CgkJCXJldHVy\nbiB0aGlzLiNvcHRpb25zLnRpbWVvdXQ7CgkJfQoKCQljb25zdCBlbGFwc2Vk\nID0gdGhpcy4jZ2V0Q3VycmVudFRpbWUoKSAtIHRoaXMuI3N0YXJ0VGltZTsK\nCQlyZXR1cm4gTWF0aC5tYXgoMCwgdGhpcy4jb3B0aW9ucy50aW1lb3V0IC0g\nZWxhcHNlZCk7Cgl9CgoJI2dldEN1cnJlbnRUaW1lKCk6IG51bWJlciB7CgkJ\ncmV0dXJuIGdsb2JhbFRoaXMucGVyZm9ybWFuY2U/Lm5vdygpID8/IERhdGUu\nbm93KCk7Cgl9CgoJI2dldE5vcm1hbGl6ZWRPcHRpb25zKCk6IE5vcm1hbGl6\nZWRPcHRpb25zIHsKCQlpZiAoIXRoaXMuI2NhY2hlZE5vcm1hbGl6ZWRPcHRp\nb25zKSB7CgkJCS8vIEV4Y2x1ZGUgS3ktc3BlY2lmaWMgb3B0aW9ucyB0aGF0\nIGFyZSBub3QgcGFydCBvZiBgUmVxdWVzdEluaXRgLgoJCQljb25zdCB7CgkJ\nCQlob29rcywKCQkJCWpzb24sCgkJCQlwYXJzZUpzb24sCgkJCQlzdHJpbmdp\nZnlKc29uLAoJCQkJc2VhcmNoUGFyYW1zLAoJCQkJdGltZW91dCwKCQkJCXRo\ncm93SHR0cEVycm9ycywKCQkJCWZldGNoLAoJCQkJLi4ubm9ybWFsaXplZE9w\ndGlvbnMKCQkJfSA9IHRoaXMuI29wdGlvbnM7CgoJCQl0aGlzLiNjYWNoZWRO\nb3JtYWxpemVkT3B0aW9ucyA9IE9iamVjdC5mcmVlemUobm9ybWFsaXplZE9w\ndGlvbnMpIGFzIE5vcm1hbGl6ZWRPcHRpb25zOwoJCX0KCgkJcmV0dXJuIHRo\naXMuI2NhY2hlZE5vcm1hbGl6ZWRPcHRpb25zOwoJfQoKCSNhc3NpZ25SZXF1\nZXN0KHJlcXVlc3Q6IFJlcXVlc3QpOiB2b2lkIHsKCQl0aGlzLiNjYWNoZWRO\nb3JtYWxpemVkT3B0aW9ucyA9IHVuZGVmaW5lZDsKCQl0aGlzLnJlcXVlc3Qg\nPSByZXF1ZXN0OwoJfQoKCSN3cmFwUmVxdWVzdFdpdGhVcGxvYWRQcm9ncmVz\ncyhyZXF1ZXN0OiBSZXF1ZXN0LCBvcmlnaW5hbEJvZHk/OiBCb2R5SW5pdCk6\nIFJlcXVlc3QgewoJCWlmICghdGhpcy4jb3B0aW9ucy5vblVwbG9hZFByb2dy\nZXNzIHx8ICFyZXF1ZXN0LmJvZHkpIHsKCQkJcmV0dXJuIHJlcXVlc3Q7CgkJ\nfQoKCQlyZXR1cm4gc3RyZWFtUmVxdWVzdChyZXF1ZXN0LCB0aGlzLiNvcHRp\nb25zLm9uVXBsb2FkUHJvZ3Jlc3MsIG9yaWdpbmFsQm9keSA/PyB0aGlzLiNv\ncHRpb25zLmJvZHkgPz8gdW5kZWZpbmVkKTsKCX0KfQo=\n", "encoding": "base64", "_links": {"self": "https://api.github.com/repos/sindresorhus/ky/contents/source/core/Ky.ts?ref=main", "git": "https://api.github.com/repos/sindresorhus/ky/git/blobs/4aaa12b8921a066965fa858e0fcbbbfdc3744f63", "html": "https://github.com/sindresorhus/ky/blob/main/source/core/Ky.ts"}}